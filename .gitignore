{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import tensorflow as tf\n",
    "import re\n",
    "import time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "#importing dataset\n",
    "qa=open('questionsAnswers.tsv',encoding='utf-8',errors='ignore').read().split('\\n')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['what is credit card?', 'A Credit Card is something that we all want, some of us have, but a lot of us don’t quite completely understand its nature. In a way, owning a Credit Card increases your purchasing power. You can use it to purchase all that you can afford, and all that you can’t quite buy cash down']\n",
      "['What happens if a check bounces?', ' If a check bounces, the payee reports the issue to debit bureaus such as ChexSystems, which collects financial data on savings and checking accounts.']\n",
      "['Why is my bank account not credited?', 'It could also be incorrect bank account details, like name of the beneficiary. In the normal course, in case the amounts are not credited the bank returns the amount to the beneficiary. It is very rare that the amounts are not credited bank, in case of some error.']\n",
      "['How do I avoid bank fees and charges?', 'You should explain the different types of fees and charges so that the customer is clear about which banking activities are free and which ones incur charges']\n",
      "['What are the different ways you can operate your accounts?', 'You can operate your bank accounts in different ways like a) Internet banking b) Telephone or Mobile banking c) Branch or Over the counter service d) ATM ( Automated Teller Machine)']\n",
      "['What are the types of accounts in banks?', 'a) Checking Account: You can access the account as the saving account but, unlike saving account, you cannot earn interest on this account. The benefit of this account is that there is no limit for withdrawal b) Saving Account: You can save your money in such account and also earn interest on it. The number of withdrawal is limited and need to maintain the minimum amount of balance in the account to remain active c) Money Market Account: This account gives benefits of both saving and checking accounts. You can withdraw the amount and yet you can earn higher interest on it. This account can be opened with a minimum balance. d) CD (Certificate of Deposits) Account: In such account you have to deposit your money for the fixed period of time (5-7 years), and you will earn the interest on it. The rate of interest is decided by the bank, and you cannot withdraw the funds until the fixed period expires.']\n",
      "['When is a deposit account considered abandoned or unclaimed?', 'Generally, an account is considered abandoned or unclaimed when there is no customer-initiated activity or contact for a period of three to five years. The specific period is based on the escheatment laws of each state.']\n",
      "['What do you mean by ‘cheque endorsing’?', '‘Endorsing cheque’ ensures that the cheque get deposited into your account only. It minimizes the risk of theft. Normally, in endorsing cheque, the cashier will ask you to sign at the back of the cheque. The signature should match the payee. The image over here shows the endorsed cheque.']\n",
      "['What are the types of Personal Loans?', ' Personal Loans are of two types: a)Unsecured Personal Loan b)Secured Personal Loan']\n",
      "['Why do we need credit cards?', 'there are many points to have a credit card like Frequent-Flyer Miles, Bonus, Reward Points,Keeping Vendors Honest, Keeping Venders Honest, Grace Period, Insurance Etc. If you are scared to use a credit card please contact us. for more details please visit https://www.investopedia.com/articles/pf/10/credit-card-debit-card.asp ']\n",
      "['How good is Credit Card cashback?', 'The cash back credit card was first popularized in the United States by Discover, and the idea was simple: Use the card and get 1% of your purchases rebated in the form of cash back. Today, the concept has grown and matured. Now, some cards now offer 2%, 3% or even as much as 6% cash back on selected purchases, though such lucrative offers involve quarterly or annual spending caps.1 The best cash back cards are those that charge minimal fees and interest, while offering a high rewards rate.']\n",
      "['Frequent-Flyer Miles', 'This perk predates almost all the rest. Back in the early 1980s, American Airlines began offering the consumers a novel way to earn frequent-flyer miles when not flying by forming a partnership with credit card giant Citibank.4 5 Now, all domestic and international airlines have at least one credit card available offered in similar partnership with major credit card issuers.']\n",
      "['How does it keep vendors honest?', \"Say you hire a tile setter to set some flooring in your entryway. Workers spend the weekend cutting, measuring, grouting, placing the spacers and tiles and letting the whole thing set. They then charge you $4,000 for their troubles. You draw upon your savings account and write a check. But what do you do when, 72 hours later, the tile starts to shift and the grout still hasn't set? Your entryway is now a complete mess, and that vein in your forehead won't stop throbbing.\"]\n",
      "['How credit card help in insurance?', \"Most credit cards automatically come with a number of consumer protections that people don't even realize they have, such as rental car insurance (though often secondary to your personal auto insurance), travel insurance, and product warranties that may exceed the manufacturer's warranty.\"]\n",
      "['what is credit point?', \"Points are incentives that can be accumulated through your credit card's cash back, reward or loyalty programs, typically in point, cash back or miles categories. These points are typically accumulated by making purchases with your credit card on specific categories, are updated each billing cycle and may be viewed or redeemed on the credit issuer, hotel or airline's online portal. When applying for a credit card, you may want to consider what type of bonus rewards the issuer offers and whether the set of approved purchases and selected retailers align with your lifestyle and spending habits.\"]\n",
      "['What do I need to apply for a credit card?', 'Applying for a credit card is a simple, straightforward process that requires some basic information. Students will need the name and location of their school in addition to a social security number and primary address. For security purposes, you may need to know your mother’s maiden name.']\n",
      "['How Annual Percentage Rate works?', 'There are a few reasons your Annual Percentage Rate can go up even if you’re up to date on all payments. These include a decrease in your credit score, the end of a card-related promotion, a change in the prime rate if you have a variable-rate card, or if you have made late payments.']\n",
      "['When should I redeem rewards on a credit card?', 'Some programs have no expiration dates and you can earn and use rewards whenever it’s convenient for you. Others have annual programs with “use it or lose it” clauses requiring that you redeem rewards within a certain time period or else forfeit their value. Be sure to read your Credit Card Agreement to understand if and when rewards expire.']\n",
      "['What are instant approval credit cards?', 'Instant approval means you’ll receive a quick answer to your application for a new credit card. Typically, only people with good to excellent credit scores are granted instant approval. Learn more about instant approval credit card offers.']\n",
      "['Will My Credit Card Make Me Overspend?', 'YES! I’d like to be fair and say it depends on you, but the fact is people with credit cards tend to overspend compared to paying only in cash. It’s a fact that our brains react differently to paying with cash or credit. When you pay with cash, you do that mental accounting to work out your balance. That keeps you from spending more than you have in savings. People don’t usually do this same mental bookkeeping when using credit.']\n",
      "['What is an Annual Fee and Where do I Find Mine?', 'Annual fees on credit cards are an additional charge, usually from $50 to $150, beyond the interest rate you pay. My first reaction is to say you should never apply for a card that charges an annual fee. Most reward program cards have annual fees though so it’s not as simple as just avoiding any card with a fee.']\n",
      "['What if I Can’t Pay My Credit Card Bills?', 'Missing payments on your credit cards will destroy your FICO and make it more expensive to get any loans. That’s why it’s important to contact your credit card issuer as soon as you start having trouble paying the bill to work out some kind of a plan.Not paying your credit card for six months and not working out a plan will usually mean the debt gets sold to a collection agency. This is the worst thing that can happen because not only will you still owe all the charges and fees but now there are two bad accounts on your credit, the card issuer and the agency.']\n",
      "['What is a Balance Transfer?', 'A balance transfer is exactly what it says, transferring the balance from one debt to another credit card. Transferring to a new card usually brings the benefit of a 0% introductory rate for six months to a year and no transfer fees.']\n",
      "['How is a Credit Card Different from a Debit Card?', 'Debit cards are linked to your checking account and you can only spend as much as you have cash available. That means it’s not a loan like a credit card so there’s no interest rate. There are also no payments so no late fees to worry about either.Debit cards might claim to be reported on your credit report, but they don’t help your credit score. You’re not making any payments so there’s no way to build up a payment history.']\n",
      "['Why do people use debit cards?', 'For many people, it is more convenient to carry a small, plastic card instead of a bulky checkbook or a large amount of cash. Using a debit card is also easier and faster than writing a check']\n",
      "['Some debit cards come with \"rewards\" or other incentives for using them. How can I know which one is a good deal?', 'For many people, it is more convenient to carry a small, plastic card instead of a bulky checkbook or a large amount of cash. Using a debit card is also easier and faster than writing a check']\n",
      "['If I use a debit card to make a purchase can the merchant put a temporary \"block\" or \"hold\" on other funds in my account?', 'Yes, in certain circumstances, merchants can take these steps as protection against fraud, errors or other losses.']\n",
      "['If I use a debit card to make a purchase can the merchant put a temporary \"block\" or \"hold\" on other funds ', 'Yes, in certain circumstances, merchants can take these steps as protection against fraud, errors or other losses.']\n",
      "['Is a Debit Card Similar to a Credit Card?', 'If you think there’s no difference between the two, you’d be wrong! A Debit Card allows you to spend money by utilising money in your bank account. Credit Cards, on the other hand, enable you to borrow money from the card issuer up to a certain limit in order to purchase items, or even withdraw cash, for which you are billed later.']\n",
      "['How safe is a Debit Card for online purchases?', 'As far as possible, never use your Debit Card for online transactions. The level of protection against fraud is much lower if you use it, and disputes can be difficult to resolve.']\n",
      "['What is a wire transfer?', 'The term “wire transfer” is often used to refer to any electronic transfer of money from one person to another. The term “wire transfer” also has a more narrow technical meaning, referring to one certain method of transferring funds, which usually involves an electronic transfer of funds from one bank or credit union account to another. ']\n",
      "['What forms of payment can I use for the transactions?', \"You can pay  by credit or debit card or you may issue an electronic check from your bank account (checking or savings). Please check the Company's website for the credit and debit cards that are eligible.\"]\n",
      "['What are the costs for paying online?', 'There are no signup costs or subscription fees. There are fees imposed by Invoice Cloud for returned payments, and your bank may charge you a fee based on the bank’s fee schedule.']\n",
      "['How long does it take for a credit card transaction to process if I pay online?', 'Credit card transactions typically take 48 hours to settle. An authorization is issued immediately; however, it takes 48 hours for the money to be moved.']\n",
      "['What information do I need to make a payment?', 'The only information you need to have available to complete an express payment transaction is your email address, password and your bank account or credit card information. Some billers do not accept express payments and then you would need your account number as well.']\n",
      "['What is Auto-Pay?', 'If you elect to opt in to Auto-Pay, it means that your bills will be paid automatically on their due date or date you choose using your default credit card or bank account. This will avoid any late fees and free you from having to remember when to pay.']\n",
      "['What is the difference between auto-pay and a scheduled payment?', 'Auto-pay is an automated process, which pays your balance in full each billing cycle 2 days prior to the due date, scheduled payments are manually entered by you for the date you choose each time you make a payment.']\n",
      "['Why has the bank blocked my transaction?', 'Sometimes banks block transactions for security reasons, particularly if it’s an unexpected payment, as they may suspect the card has been stolen and is being used fraudulently. If your transaction has been blocked, you should contact your bank to authorise the payment. You’ll need to provide details of your transaction: date, time and the amount of money sent.']\n",
      "['Are There Fees Attached to Having a Debit Card?', 'All banks have fees that go along with the Debit Cards they issue. However, the fees and other charges also depend upon the type of account you have. These charges are associated with:']\n",
      "['Visa or Mastercard – Why?', 'One of the first things you’ll notice about your Debit Card is a Visa or Mastercard logo on it. The truth is, it doesn’t really matter who the bank’s transactions partner is, as both are accepted globally for payments.']\n",
      "['How do I get a Debit card if I have no Dedit history?', 'There are plenty of options on the market for people with limited credit history. Shop around to find the card with the lowest APR and fees you can qualify for.']\n",
      "['How old do you have to be to get Dedit card?', '18 is typically the minimum age to apply independently for a Dedit card in India. However, people under 18 can be added as authorized users to their parents’ accounts.']\n",
      "['If you are shopping online, is it better to pay by credit card or debit card?', 'Advantages to online shopping with a credit card over a debit card usually include more purchase protection along with additional warranties and rewards. Not all cards are created equal, but many of the top credit cards offer benefits such as purchase protection, extended warranties, return guarantees, and rewards programs.']\n",
      "['How do I check my bank account balance without a mobile number?', 'Customers can check their BOB account balance without a mobile number by logging into the net-banking portal provided by the bank. After login, go to ‘Accounts’, select your bank account, select ‘Account Query’ and click on ‘Account Balance’.']\n",
      "['Can banks take cheques from other banks?', 'All banks might have clerks to take cheques drawn on other banks to those banks, and wait for payment. Clearing houses were set up to streamline the process by collected all cheques drawn on other banks, and collecting payment from those banks for the total to be cleared. As volume grew, more efficient sorting methods were developed.']\n",
      "['What is check kiting?', 'Check-kiting is also known as “taking advantage of the float.” Float time is the amount of time between when an individual submits a check as payment and when the individual’s bank is instructed to move the funds from the account.']\n",
      "['What happens if you bounce a fake check?', 'First, it is fraudulent to willingly and knowingly deposit a fake check. Second, when it bounces, and you know it will, the bank will come after you for the funds, plus their fees, which could amount to $100 or more. Then, comes the part when they call the police and have you arrested for fraud.']\n",
      "['Can YOU Cash a check at an ATM?', 'No, you usually can’t cash a check at an ATM. ATMs have a limit to the amount of cash inside of them and can run out of money. Furthermore, most banks need to ensure the check you deposit has the funds in that account to cover the amount of the check. Therefore, they won’t allow access to the funds from.']\n",
      "['How do check deposits work at the ATM?', \"Video of the Day. The ATM will prompt you to insert the checks into a special slot for check deposits. Once the slot closes, you'll need to wait until the ATM verifies the amount of your check. If you deposit more than one check, the ATM displays an image of each one so you can verify the amounts before you complete the deposit.\"]\n",
      "['How does an ATM deposit increase risk?', 'How the check was deposited. A mobile or ATM deposit increase risk due to the anonymity they afford the depositor. If there are sufficient funds in the account to cover the check value. The length of the institution’s relationship with the customer. A new customer brings an elevated risk compared to an established relationship.']\n",
      "['Is a bank check guaranteed funds?', 'It can be called an official check, teller’s check, cashier’s check and a bank draft among many others. A bank check is often treated as cash because it is drawn upon a bank account and funds are withdrawn immediately. This is why a bank check is guaranteed funds.']\n",
      "['What happens if you deposit a fake check?', 'If a person knowingly deposits a fake check, with the intent to obtain money that is not theirs or to deceive a bank employee, they will usually be subject to criminal consequences. These consequences can include jail time and/or criminal fines.']\n",
      "['What happens if I use a deposit ATM from another bank?', \"If you use a deposit ATM from another bank (within the network) your funds may not show up in your account as quickly. That's fine if you've got sufficient funds in your account, but it can cause overdrafts, fees, and other problems if you don't.\"]\n",
      "['How does a fraudster deposit a fake check?', 'The fraudster uses the information to deposit a fake check. Once the deposit has been made, the scammer will request funds to be immediately transferred back to them via money order, person to person transfer, wire transfer, reloadable cards or even gift cards.']\n",
      "['What happens if a check is not deposited?', 'If the deposited check was not the result of fraudulent activity, the bank will require you to pay any fees and overdraft charges that occur on your account as a result of the check. If the fees cause your account to have a negative balance, and you fail to pay it, the bank may close the account and report you to ChexSystems.']\n",
      "['Can I deposit fraudulent money into my bank account?', 'If you knowingly allow someone to deposit fraudulent money into your bank account—and the fraud is discovered—you could be charged with a crime. This is one way people “launder” money. Depositing money into another person’s account can be seen as an attempt to remove the evidence of the real source of the money.']\n",
      "['Is check overpayment scam fraudulent?', 'After obtaining a victim\\'s bank account, Social Security number and other details, they may actually send a loan payment or direct deposit. The victim may be asked to make an immediate good faith payment out of that money but as with the check overpayment scam, the \"loan\" is fraudulent.']\n",
      "['What happens if you deposit a fake check?', 'If a person knowingly deposits a fake check, with the intent to obtain money that is not theirs or to deceive a bank employee, they will usually be subject to criminal consequences. These consequences can include jail time and/or criminal fines.']\n"
     ]
    }
   ],
   "source": [
    "questions=[]\n",
    "answers=[]\n",
    "for i in range(len(qa)):\n",
    "    if i%2==0:\n",
    "        line=qa[i].split('\t')\n",
    "        print(line)\n",
    "        q=line[0]\n",
    "        a=line[1]\n",
    "        questions.append(q)\n",
    "        answers.append(a)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['what is credit card?',\n",
       " 'What happens if a check bounces?',\n",
       " 'Why is my bank account not credited?',\n",
       " 'How do I avoid bank fees and charges?',\n",
       " 'What are the different ways you can operate your accounts?',\n",
       " 'What are the types of accounts in banks?',\n",
       " 'When is a deposit account considered abandoned or unclaimed?',\n",
       " 'What do you mean by ‘cheque endorsing’?',\n",
       " 'What are the types of Personal Loans?',\n",
       " 'Why do we need credit cards?',\n",
       " 'How good is Credit Card cashback?',\n",
       " 'Frequent-Flyer Miles',\n",
       " 'How does it keep vendors honest?',\n",
       " 'How credit card help in insurance?',\n",
       " 'what is credit point?',\n",
       " 'What do I need to apply for a credit card?',\n",
       " 'How Annual Percentage Rate works?',\n",
       " 'When should I redeem rewards on a credit card?',\n",
       " 'What are instant approval credit cards?',\n",
       " 'Will My Credit Card Make Me Overspend?',\n",
       " 'What is an Annual Fee and Where do I Find Mine?',\n",
       " 'What if I Can’t Pay My Credit Card Bills?',\n",
       " 'What is a Balance Transfer?',\n",
       " 'How is a Credit Card Different from a Debit Card?',\n",
       " 'Why do people use debit cards?',\n",
       " 'Some debit cards come with \"rewards\" or other incentives for using them. How can I know which one is a good deal?',\n",
       " 'If I use a debit card to make a purchase can the merchant put a temporary \"block\" or \"hold\" on other funds in my account?',\n",
       " 'If I use a debit card to make a purchase can the merchant put a temporary \"block\" or \"hold\" on other funds ',\n",
       " 'Is a Debit Card Similar to a Credit Card?',\n",
       " 'How safe is a Debit Card for online purchases?',\n",
       " 'What is a wire transfer?',\n",
       " 'What forms of payment can I use for the transactions?',\n",
       " 'What are the costs for paying online?',\n",
       " 'How long does it take for a credit card transaction to process if I pay online?',\n",
       " 'What information do I need to make a payment?',\n",
       " 'What is Auto-Pay?',\n",
       " 'What is the difference between auto-pay and a scheduled payment?',\n",
       " 'Why has the bank blocked my transaction?',\n",
       " 'Are There Fees Attached to Having a Debit Card?',\n",
       " 'Visa or Mastercard – Why?',\n",
       " 'How do I get a Debit card if I have no Dedit history?',\n",
       " 'How old do you have to be to get Dedit card?',\n",
       " 'If you are shopping online, is it better to pay by credit card or debit card?',\n",
       " 'How do I check my bank account balance without a mobile number?',\n",
       " 'Can banks take cheques from other banks?',\n",
       " 'What is check kiting?',\n",
       " 'What happens if you bounce a fake check?',\n",
       " 'Can YOU Cash a check at an ATM?',\n",
       " 'How do check deposits work at the ATM?',\n",
       " 'How does an ATM deposit increase risk?',\n",
       " 'Is a bank check guaranteed funds?',\n",
       " 'What happens if you deposit a fake check?',\n",
       " 'What happens if I use a deposit ATM from another bank?',\n",
       " 'How does a fraudster deposit a fake check?',\n",
       " 'What happens if a check is not deposited?',\n",
       " 'Can I deposit fraudulent money into my bank account?',\n",
       " 'Is check overpayment scam fraudulent?',\n",
       " 'What happens if you deposit a fake check?']"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "questions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['A Credit Card is something that we all want, some of us have, but a lot of us don’t quite completely understand its nature. In a way, owning a Credit Card increases your purchasing power. You can use it to purchase all that you can afford, and all that you can’t quite buy cash down',\n",
       " ' If a check bounces, the payee reports the issue to debit bureaus such as ChexSystems, which collects financial data on savings and checking accounts.',\n",
       " 'It could also be incorrect bank account details, like name of the beneficiary. In the normal course, in case the amounts are not credited the bank returns the amount to the beneficiary. It is very rare that the amounts are not credited bank, in case of some error.',\n",
       " 'You should explain the different types of fees and charges so that the customer is clear about which banking activities are free and which ones incur charges',\n",
       " 'You can operate your bank accounts in different ways like a) Internet banking b) Telephone or Mobile banking c) Branch or Over the counter service d) ATM ( Automated Teller Machine)',\n",
       " 'a) Checking Account: You can access the account as the saving account but, unlike saving account, you cannot earn interest on this account. The benefit of this account is that there is no limit for withdrawal b) Saving Account: You can save your money in such account and also earn interest on it. The number of withdrawal is limited and need to maintain the minimum amount of balance in the account to remain active c) Money Market Account: This account gives benefits of both saving and checking accounts. You can withdraw the amount and yet you can earn higher interest on it. This account can be opened with a minimum balance. d) CD (Certificate of Deposits) Account: In such account you have to deposit your money for the fixed period of time (5-7 years), and you will earn the interest on it. The rate of interest is decided by the bank, and you cannot withdraw the funds until the fixed period expires.',\n",
       " 'Generally, an account is considered abandoned or unclaimed when there is no customer-initiated activity or contact for a period of three to five years. The specific period is based on the escheatment laws of each state.',\n",
       " '‘Endorsing cheque’ ensures that the cheque get deposited into your account only. It minimizes the risk of theft. Normally, in endorsing cheque, the cashier will ask you to sign at the back of the cheque. The signature should match the payee. The image over here shows the endorsed cheque.',\n",
       " ' Personal Loans are of two types: a)Unsecured Personal Loan b)Secured Personal Loan',\n",
       " 'there are many points to have a credit card like Frequent-Flyer Miles, Bonus, Reward Points,Keeping Vendors Honest, Keeping Venders Honest, Grace Period, Insurance Etc. If you are scared to use a credit card please contact us. for more details please visit https://www.investopedia.com/articles/pf/10/credit-card-debit-card.asp ',\n",
       " 'The cash back credit card was first popularized in the United States by Discover, and the idea was simple: Use the card and get 1% of your purchases rebated in the form of cash back. Today, the concept has grown and matured. Now, some cards now offer 2%, 3% or even as much as 6% cash back on selected purchases, though such lucrative offers involve quarterly or annual spending caps.1 The best cash back cards are those that charge minimal fees and interest, while offering a high rewards rate.',\n",
       " 'This perk predates almost all the rest. Back in the early 1980s, American Airlines began offering the consumers a novel way to earn frequent-flyer miles when not flying by forming a partnership with credit card giant Citibank.4 5 Now, all domestic and international airlines have at least one credit card available offered in similar partnership with major credit card issuers.',\n",
       " \"Say you hire a tile setter to set some flooring in your entryway. Workers spend the weekend cutting, measuring, grouting, placing the spacers and tiles and letting the whole thing set. They then charge you $4,000 for their troubles. You draw upon your savings account and write a check. But what do you do when, 72 hours later, the tile starts to shift and the grout still hasn't set? Your entryway is now a complete mess, and that vein in your forehead won't stop throbbing.\",\n",
       " \"Most credit cards automatically come with a number of consumer protections that people don't even realize they have, such as rental car insurance (though often secondary to your personal auto insurance), travel insurance, and product warranties that may exceed the manufacturer's warranty.\",\n",
       " \"Points are incentives that can be accumulated through your credit card's cash back, reward or loyalty programs, typically in point, cash back or miles categories. These points are typically accumulated by making purchases with your credit card on specific categories, are updated each billing cycle and may be viewed or redeemed on the credit issuer, hotel or airline's online portal. When applying for a credit card, you may want to consider what type of bonus rewards the issuer offers and whether the set of approved purchases and selected retailers align with your lifestyle and spending habits.\",\n",
       " 'Applying for a credit card is a simple, straightforward process that requires some basic information. Students will need the name and location of their school in addition to a social security number and primary address. For security purposes, you may need to know your mother’s maiden name.',\n",
       " 'There are a few reasons your Annual Percentage Rate can go up even if you’re up to date on all payments. These include a decrease in your credit score, the end of a card-related promotion, a change in the prime rate if you have a variable-rate card, or if you have made late payments.',\n",
       " 'Some programs have no expiration dates and you can earn and use rewards whenever it’s convenient for you. Others have annual programs with “use it or lose it” clauses requiring that you redeem rewards within a certain time period or else forfeit their value. Be sure to read your Credit Card Agreement to understand if and when rewards expire.',\n",
       " 'Instant approval means you’ll receive a quick answer to your application for a new credit card. Typically, only people with good to excellent credit scores are granted instant approval. Learn more about instant approval credit card offers.',\n",
       " 'YES! I’d like to be fair and say it depends on you, but the fact is people with credit cards tend to overspend compared to paying only in cash. It’s a fact that our brains react differently to paying with cash or credit. When you pay with cash, you do that mental accounting to work out your balance. That keeps you from spending more than you have in savings. People don’t usually do this same mental bookkeeping when using credit.',\n",
       " 'Annual fees on credit cards are an additional charge, usually from $50 to $150, beyond the interest rate you pay. My first reaction is to say you should never apply for a card that charges an annual fee. Most reward program cards have annual fees though so it’s not as simple as just avoiding any card with a fee.',\n",
       " 'Missing payments on your credit cards will destroy your FICO and make it more expensive to get any loans. That’s why it’s important to contact your credit card issuer as soon as you start having trouble paying the bill to work out some kind of a plan.Not paying your credit card for six months and not working out a plan will usually mean the debt gets sold to a collection agency. This is the worst thing that can happen because not only will you still owe all the charges and fees but now there are two bad accounts on your credit, the card issuer and the agency.',\n",
       " 'A balance transfer is exactly what it says, transferring the balance from one debt to another credit card. Transferring to a new card usually brings the benefit of a 0% introductory rate for six months to a year and no transfer fees.',\n",
       " 'Debit cards are linked to your checking account and you can only spend as much as you have cash available. That means it’s not a loan like a credit card so there’s no interest rate. There are also no payments so no late fees to worry about either.Debit cards might claim to be reported on your credit report, but they don’t help your credit score. You’re not making any payments so there’s no way to build up a payment history.',\n",
       " 'For many people, it is more convenient to carry a small, plastic card instead of a bulky checkbook or a large amount of cash. Using a debit card is also easier and faster than writing a check',\n",
       " 'For many people, it is more convenient to carry a small, plastic card instead of a bulky checkbook or a large amount of cash. Using a debit card is also easier and faster than writing a check',\n",
       " 'Yes, in certain circumstances, merchants can take these steps as protection against fraud, errors or other losses.',\n",
       " 'Yes, in certain circumstances, merchants can take these steps as protection against fraud, errors or other losses.',\n",
       " 'If you think there’s no difference between the two, you’d be wrong! A Debit Card allows you to spend money by utilising money in your bank account. Credit Cards, on the other hand, enable you to borrow money from the card issuer up to a certain limit in order to purchase items, or even withdraw cash, for which you are billed later.',\n",
       " 'As far as possible, never use your Debit Card for online transactions. The level of protection against fraud is much lower if you use it, and disputes can be difficult to resolve.',\n",
       " 'The term “wire transfer” is often used to refer to any electronic transfer of money from one person to another. The term “wire transfer” also has a more narrow technical meaning, referring to one certain method of transferring funds, which usually involves an electronic transfer of funds from one bank or credit union account to another. ',\n",
       " \"You can pay  by credit or debit card or you may issue an electronic check from your bank account (checking or savings). Please check the Company's website for the credit and debit cards that are eligible.\",\n",
       " 'There are no signup costs or subscription fees. There are fees imposed by Invoice Cloud for returned payments, and your bank may charge you a fee based on the bank’s fee schedule.',\n",
       " 'Credit card transactions typically take 48 hours to settle. An authorization is issued immediately; however, it takes 48 hours for the money to be moved.',\n",
       " 'The only information you need to have available to complete an express payment transaction is your email address, password and your bank account or credit card information. Some billers do not accept express payments and then you would need your account number as well.',\n",
       " 'If you elect to opt in to Auto-Pay, it means that your bills will be paid automatically on their due date or date you choose using your default credit card or bank account. This will avoid any late fees and free you from having to remember when to pay.',\n",
       " 'Auto-pay is an automated process, which pays your balance in full each billing cycle 2 days prior to the due date, scheduled payments are manually entered by you for the date you choose each time you make a payment.',\n",
       " 'Sometimes banks block transactions for security reasons, particularly if it’s an unexpected payment, as they may suspect the card has been stolen and is being used fraudulently. If your transaction has been blocked, you should contact your bank to authorise the payment. You’ll need to provide details of your transaction: date, time and the amount of money sent.',\n",
       " 'All banks have fees that go along with the Debit Cards they issue. However, the fees and other charges also depend upon the type of account you have. These charges are associated with:',\n",
       " 'One of the first things you’ll notice about your Debit Card is a Visa or Mastercard logo on it. The truth is, it doesn’t really matter who the bank’s transactions partner is, as both are accepted globally for payments.',\n",
       " 'There are plenty of options on the market for people with limited credit history. Shop around to find the card with the lowest APR and fees you can qualify for.',\n",
       " '18 is typically the minimum age to apply independently for a Dedit card in India. However, people under 18 can be added as authorized users to their parents’ accounts.',\n",
       " 'Advantages to online shopping with a credit card over a debit card usually include more purchase protection along with additional warranties and rewards. Not all cards are created equal, but many of the top credit cards offer benefits such as purchase protection, extended warranties, return guarantees, and rewards programs.',\n",
       " 'Customers can check their BOB account balance without a mobile number by logging into the net-banking portal provided by the bank. After login, go to ‘Accounts’, select your bank account, select ‘Account Query’ and click on ‘Account Balance’.',\n",
       " 'All banks might have clerks to take cheques drawn on other banks to those banks, and wait for payment. Clearing houses were set up to streamline the process by collected all cheques drawn on other banks, and collecting payment from those banks for the total to be cleared. As volume grew, more efficient sorting methods were developed.',\n",
       " 'Check-kiting is also known as “taking advantage of the float.” Float time is the amount of time between when an individual submits a check as payment and when the individual’s bank is instructed to move the funds from the account.',\n",
       " 'First, it is fraudulent to willingly and knowingly deposit a fake check. Second, when it bounces, and you know it will, the bank will come after you for the funds, plus their fees, which could amount to $100 or more. Then, comes the part when they call the police and have you arrested for fraud.',\n",
       " 'No, you usually can’t cash a check at an ATM. ATMs have a limit to the amount of cash inside of them and can run out of money. Furthermore, most banks need to ensure the check you deposit has the funds in that account to cover the amount of the check. Therefore, they won’t allow access to the funds from.',\n",
       " \"Video of the Day. The ATM will prompt you to insert the checks into a special slot for check deposits. Once the slot closes, you'll need to wait until the ATM verifies the amount of your check. If you deposit more than one check, the ATM displays an image of each one so you can verify the amounts before you complete the deposit.\",\n",
       " 'How the check was deposited. A mobile or ATM deposit increase risk due to the anonymity they afford the depositor. If there are sufficient funds in the account to cover the check value. The length of the institution’s relationship with the customer. A new customer brings an elevated risk compared to an established relationship.',\n",
       " 'It can be called an official check, teller’s check, cashier’s check and a bank draft among many others. A bank check is often treated as cash because it is drawn upon a bank account and funds are withdrawn immediately. This is why a bank check is guaranteed funds.',\n",
       " 'If a person knowingly deposits a fake check, with the intent to obtain money that is not theirs or to deceive a bank employee, they will usually be subject to criminal consequences. These consequences can include jail time and/or criminal fines.',\n",
       " \"If you use a deposit ATM from another bank (within the network) your funds may not show up in your account as quickly. That's fine if you've got sufficient funds in your account, but it can cause overdrafts, fees, and other problems if you don't.\",\n",
       " 'The fraudster uses the information to deposit a fake check. Once the deposit has been made, the scammer will request funds to be immediately transferred back to them via money order, person to person transfer, wire transfer, reloadable cards or even gift cards.',\n",
       " 'If the deposited check was not the result of fraudulent activity, the bank will require you to pay any fees and overdraft charges that occur on your account as a result of the check. If the fees cause your account to have a negative balance, and you fail to pay it, the bank may close the account and report you to ChexSystems.',\n",
       " 'If you knowingly allow someone to deposit fraudulent money into your bank account—and the fraud is discovered—you could be charged with a crime. This is one way people “launder” money. Depositing money into another person’s account can be seen as an attempt to remove the evidence of the real source of the money.',\n",
       " 'After obtaining a victim\\'s bank account, Social Security number and other details, they may actually send a loan payment or direct deposit. The victim may be asked to make an immediate good faith payment out of that money but as with the check overpayment scam, the \"loan\" is fraudulent.',\n",
       " 'If a person knowingly deposits a fake check, with the intent to obtain money that is not theirs or to deceive a bank employee, they will usually be subject to criminal consequences. These consequences can include jail time and/or criminal fines.']"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "answers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [],
   "source": [
    "#clean text\n",
    "def clean_text(text):\n",
    "    text=text.lower()\n",
    "#     print(text)\n",
    "    text=re.sub(r\"i'm\",\"i am\",text)\n",
    "    text=re.sub(r\"she's\",\"she is\",text)\n",
    "    text=re.sub(r\"he's\",\"he is\",text)\n",
    "    text=re.sub(r\"that's\",\"that is\",text)\n",
    "    text=re.sub(r\"what's\",\"what is\",text)\n",
    "    text=re.sub(r\"where's\",\"where is\",text)\n",
    "    text=re.sub(r\"\\'ve\",\" have\",text)\n",
    "    text=re.sub(r\"\\'re\",\" are\",text)\n",
    "    text=re.sub(r\"\\'d\",\" would\",text)\n",
    "    text=re.sub(r\"won't\",\"will not\",text)\n",
    "    text=re.sub(r\"can't\",\"cannot\",text)\n",
    "#     print(text)\n",
    "    text=re.sub(r\"[-,\\@=;./?''<>|{}+():*#]\",\"\",text)\n",
    "    text=re.sub(r'[\"\"]','',text)\n",
    "    text=re.sub(r\"  \",\" \",text)\n",
    "#     print(text)\n",
    "    return text"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [],
   "source": [
    "clean_questions=[]\n",
    "clean_answers=[]\n",
    "for i in questions:\n",
    "    clean_questions.append(clean_text(i))\n",
    "for i in answers:\n",
    "    clean_answers.append(clean_text(i))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['what is credit card',\n",
       " 'what happens if a check bounces',\n",
       " 'why is my bank account not credited',\n",
       " 'how do i avoid bank fees and charges',\n",
       " 'what are the different ways you can operate your accounts',\n",
       " 'what are the types of accounts in banks',\n",
       " 'when is a deposit account considered abandoned or unclaimed',\n",
       " 'what do you mean by ‘cheque endorsing’',\n",
       " 'what are the types of personal loans',\n",
       " 'why do we need credit cards',\n",
       " 'how good is credit card cashback',\n",
       " 'frequentflyer miles',\n",
       " 'how does it keep vendors honest',\n",
       " 'how credit card help in insurance',\n",
       " 'what is credit point',\n",
       " 'what do i need to apply for a credit card',\n",
       " 'how annual percentage rate works',\n",
       " 'when should i redeem rewards on a credit card',\n",
       " 'what are instant approval credit cards',\n",
       " 'will my credit card make me overspend',\n",
       " 'what is an annual fee and where do i find mine',\n",
       " 'what if i can’t pay my credit card bills',\n",
       " 'what is a balance transfer',\n",
       " 'how is a credit card different from a debit card',\n",
       " 'why do people use debit cards',\n",
       " 'some debit cards come with rewards or other incentives for using them how can i know which one is a good deal',\n",
       " 'if i use a debit card to make a purchase can the merchant put a temporary block or hold on other funds in my account',\n",
       " 'if i use a debit card to make a purchase can the merchant put a temporary block or hold on other funds ',\n",
       " 'is a debit card similar to a credit card',\n",
       " 'how safe is a debit card for online purchases',\n",
       " 'what is a wire transfer',\n",
       " 'what forms of payment can i use for the transactions',\n",
       " 'what are the costs for paying online',\n",
       " 'how long does it take for a credit card transaction to process if i pay online',\n",
       " 'what information do i need to make a payment',\n",
       " 'what is autopay',\n",
       " 'what is the difference between autopay and a scheduled payment',\n",
       " 'why has the bank blocked my transaction',\n",
       " 'are there fees attached to having a debit card',\n",
       " 'visa or mastercard – why',\n",
       " 'how do i get a debit card if i have no dedit history',\n",
       " 'how old do you have to be to get dedit card',\n",
       " 'if you are shopping online is it better to pay by credit card or debit card',\n",
       " 'how do i check my bank account balance without a mobile number',\n",
       " 'can banks take cheques from other banks',\n",
       " 'what is check kiting',\n",
       " 'what happens if you bounce a fake check',\n",
       " 'can you cash a check at an atm',\n",
       " 'how do check deposits work at the atm',\n",
       " 'how does an atm deposit increase risk',\n",
       " 'is a bank check guaranteed funds',\n",
       " 'what happens if you deposit a fake check',\n",
       " 'what happens if i use a deposit atm from another bank',\n",
       " 'how does a fraudster deposit a fake check',\n",
       " 'what happens if a check is not deposited',\n",
       " 'can i deposit fraudulent money into my bank account',\n",
       " 'is check overpayment scam fraudulent',\n",
       " 'what happens if you deposit a fake check']"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "clean_questions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['a credit card is something that we all want some of us have but a lot of us don’t quite completely understand its nature in a way owning a credit card increases your purchasing power you can use it to purchase all that you can afford and all that you can’t quite buy cash down',\n",
       " ' if a check bounces the payee reports the issue to debit bureaus such as chexsystems which collects financial data on savings and checking accounts',\n",
       " 'it could also be incorrect bank account details like name of the beneficiary in the normal course in case the amounts are not credited the bank returns the amount to the beneficiary it is very rare that the amounts are not credited bank in case of some error',\n",
       " 'you should explain the different types of fees and charges so that the customer is clear about which banking activities are free and which ones incur charges',\n",
       " 'you can operate your bank accounts in different ways like a internet banking b telephone or mobile banking c branch or over the counter service d atm automated teller machine',\n",
       " 'a checking account you can access the account as the saving account but unlike saving account you cannot earn interest on this account the benefit of this account is that there is no limit for withdrawal b saving account you can save your money in such account and also earn interest on it the number of withdrawal is limited and need to maintain the minimum amount of balance in the account to remain active c money market account this account gives benefits of both saving and checking accounts you can withdraw the amount and yet you can earn higher interest on it this account can be opened with a minimum balance d cd certificate of deposits account in such account you have to deposit your money for the fixed period of time 57 years and you will earn the interest on it the rate of interest is decided by the bank and you cannot withdraw the funds until the fixed period expires',\n",
       " 'generally an account is considered abandoned or unclaimed when there is no customerinitiated activity or contact for a period of three to five years the specific period is based on the escheatment laws of each state',\n",
       " '‘endorsing cheque’ ensures that the cheque get deposited into your account only it minimizes the risk of theft normally in endorsing cheque the cashier will ask you to sign at the back of the cheque the signature should match the payee the image over here shows the endorsed cheque',\n",
       " ' personal loans are of two types aunsecured personal loan bsecured personal loan',\n",
       " 'there are many points to have a credit card like frequentflyer miles bonus reward pointskeeping vendors honest keeping venders honest grace period insurance etc if you are scared to use a credit card please contact us for more details please visit httpswwwinvestopediacomarticlespf10creditcarddebitcardasp ',\n",
       " 'the cash back credit card was first popularized in the united states by discover and the idea was simple use the card and get 1% of your purchases rebated in the form of cash back today the concept has grown and matured now some cards now offer 2% 3% or even as much as 6% cash back on selected purchases though such lucrative offers involve quarterly or annual spending caps1 the best cash back cards are those that charge minimal fees and interest while offering a high rewards rate',\n",
       " 'this perk predates almost all the rest back in the early 1980s american airlines began offering the consumers a novel way to earn frequentflyer miles when not flying by forming a partnership with credit card giant citibank4 5 now all domestic and international airlines have at least one credit card available offered in similar partnership with major credit card issuers',\n",
       " 'say you hire a tile setter to set some flooring in your entryway workers spend the weekend cutting measuring grouting placing the spacers and tiles and letting the whole thing set they then charge you $4000 for their troubles you draw upon your savings account and write a check but what do you do when 72 hours later the tile starts to shift and the grout still hasnt set your entryway is now a complete mess and that vein in your forehead will not stop throbbing',\n",
       " 'most credit cards automatically come with a number of consumer protections that people dont even realize they have such as rental car insurance though often secondary to your personal auto insurance travel insurance and product warranties that may exceed the manufacturers warranty',\n",
       " 'points are incentives that can be accumulated through your credit cards cash back reward or loyalty programs typically in point cash back or miles categories these points are typically accumulated by making purchases with your credit card on specific categories are updated each billing cycle and may be viewed or redeemed on the credit issuer hotel or airlines online portal when applying for a credit card you may want to consider what type of bonus rewards the issuer offers and whether the set of approved purchases and selected retailers align with your lifestyle and spending habits',\n",
       " 'applying for a credit card is a simple straightforward process that requires some basic information students will need the name and location of their school in addition to a social security number and primary address for security purposes you may need to know your mother’s maiden name',\n",
       " 'there are a few reasons your annual percentage rate can go up even if you’re up to date on all payments these include a decrease in your credit score the end of a cardrelated promotion a change in the prime rate if you have a variablerate card or if you have made late payments',\n",
       " 'some programs have no expiration dates and you can earn and use rewards whenever it’s convenient for you others have annual programs with “use it or lose it” clauses requiring that you redeem rewards within a certain time period or else forfeit their value be sure to read your credit card agreement to understand if and when rewards expire',\n",
       " 'instant approval means you’ll receive a quick answer to your application for a new credit card typically only people with good to excellent credit scores are granted instant approval learn more about instant approval credit card offers',\n",
       " 'yes! i’d like to be fair and say it depends on you but the fact is people with credit cards tend to overspend compared to paying only in cash it’s a fact that our brains react differently to paying with cash or credit when you pay with cash you do that mental accounting to work out your balance that keeps you from spending more than you have in savings people don’t usually do this same mental bookkeeping when using credit',\n",
       " 'annual fees on credit cards are an additional charge usually from $50 to $150 beyond the interest rate you pay my first reaction is to say you should never apply for a card that charges an annual fee most reward program cards have annual fees though so it’s not as simple as just avoiding any card with a fee',\n",
       " 'missing payments on your credit cards will destroy your fico and make it more expensive to get any loans that’s why it’s important to contact your credit card issuer as soon as you start having trouble paying the bill to work out some kind of a plannot paying your credit card for six months and not working out a plan will usually mean the debt gets sold to a collection agency this is the worst thing that can happen because not only will you still owe all the charges and fees but now there are two bad accounts on your credit the card issuer and the agency',\n",
       " 'a balance transfer is exactly what it says transferring the balance from one debt to another credit card transferring to a new card usually brings the benefit of a 0% introductory rate for six months to a year and no transfer fees',\n",
       " 'debit cards are linked to your checking account and you can only spend as much as you have cash available that means it’s not a loan like a credit card so there’s no interest rate there are also no payments so no late fees to worry about eitherdebit cards might claim to be reported on your credit report but they don’t help your credit score you’re not making any payments so there’s no way to build up a payment history',\n",
       " 'for many people it is more convenient to carry a small plastic card instead of a bulky checkbook or a large amount of cash using a debit card is also easier and faster than writing a check',\n",
       " 'for many people it is more convenient to carry a small plastic card instead of a bulky checkbook or a large amount of cash using a debit card is also easier and faster than writing a check',\n",
       " 'yes in certain circumstances merchants can take these steps as protection against fraud errors or other losses',\n",
       " 'yes in certain circumstances merchants can take these steps as protection against fraud errors or other losses',\n",
       " 'if you think there’s no difference between the two you’d be wrong! a debit card allows you to spend money by utilising money in your bank account credit cards on the other hand enable you to borrow money from the card issuer up to a certain limit in order to purchase items or even withdraw cash for which you are billed later',\n",
       " 'as far as possible never use your debit card for online transactions the level of protection against fraud is much lower if you use it and disputes can be difficult to resolve',\n",
       " 'the term “wire transfer” is often used to refer to any electronic transfer of money from one person to another the term “wire transfer” also has a more narrow technical meaning referring to one certain method of transferring funds which usually involves an electronic transfer of funds from one bank or credit union account to another ',\n",
       " 'you can pay by credit or debit card or you may issue an electronic check from your bank account checking or savings please check the companys website for the credit and debit cards that are eligible',\n",
       " 'there are no signup costs or subscription fees there are fees imposed by invoice cloud for returned payments and your bank may charge you a fee based on the bank’s fee schedule',\n",
       " 'credit card transactions typically take 48 hours to settle an authorization is issued immediately however it takes 48 hours for the money to be moved',\n",
       " 'the only information you need to have available to complete an express payment transaction is your email address password and your bank account or credit card information some billers do not accept express payments and then you would need your account number as well',\n",
       " 'if you elect to opt in to autopay it means that your bills will be paid automatically on their due date or date you choose using your default credit card or bank account this will avoid any late fees and free you from having to remember when to pay',\n",
       " 'autopay is an automated process which pays your balance in full each billing cycle 2 days prior to the due date scheduled payments are manually entered by you for the date you choose each time you make a payment',\n",
       " 'sometimes banks block transactions for security reasons particularly if it’s an unexpected payment as they may suspect the card has been stolen and is being used fraudulently if your transaction has been blocked you should contact your bank to authorise the payment you’ll need to provide details of your transaction date time and the amount of money sent',\n",
       " 'all banks have fees that go along with the debit cards they issue however the fees and other charges also depend upon the type of account you have these charges are associated with',\n",
       " 'one of the first things you’ll notice about your debit card is a visa or mastercard logo on it the truth is it doesn’t really matter who the bank’s transactions partner is as both are accepted globally for payments',\n",
       " 'there are plenty of options on the market for people with limited credit history shop around to find the card with the lowest apr and fees you can qualify for',\n",
       " '18 is typically the minimum age to apply independently for a dedit card in india however people under 18 can be added as authorized users to their parents’ accounts',\n",
       " 'advantages to online shopping with a credit card over a debit card usually include more purchase protection along with additional warranties and rewards not all cards are created equal but many of the top credit cards offer benefits such as purchase protection extended warranties return guarantees and rewards programs',\n",
       " 'customers can check their bob account balance without a mobile number by logging into the netbanking portal provided by the bank after login go to ‘accounts’ select your bank account select ‘account query’ and click on ‘account balance’',\n",
       " 'all banks might have clerks to take cheques drawn on other banks to those banks and wait for payment clearing houses were set up to streamline the process by collected all cheques drawn on other banks and collecting payment from those banks for the total to be cleared as volume grew more efficient sorting methods were developed',\n",
       " 'checkkiting is also known as “taking advantage of the float” float time is the amount of time between when an individual submits a check as payment and when the individual’s bank is instructed to move the funds from the account',\n",
       " 'first it is fraudulent to willingly and knowingly deposit a fake check second when it bounces and you know it will the bank will come after you for the funds plus their fees which could amount to $100 or more then comes the part when they call the police and have you arrested for fraud',\n",
       " 'no you usually can’t cash a check at an atm atms have a limit to the amount of cash inside of them and can run out of money furthermore most banks need to ensure the check you deposit has the funds in that account to cover the amount of the check therefore they won’t allow access to the funds from',\n",
       " 'video of the day the atm will prompt you to insert the checks into a special slot for check deposits once the slot closes youll need to wait until the atm verifies the amount of your check if you deposit more than one check the atm displays an image of each one so you can verify the amounts before you complete the deposit',\n",
       " 'how the check was deposited a mobile or atm deposit increase risk due to the anonymity they afford the depositor if there are sufficient funds in the account to cover the check value the length of the institution’s relationship with the customer a new customer brings an elevated risk compared to an established relationship',\n",
       " 'it can be called an official check teller’s check cashier’s check and a bank draft among many others a bank check is often treated as cash because it is drawn upon a bank account and funds are withdrawn immediately this is why a bank check is guaranteed funds',\n",
       " 'if a person knowingly deposits a fake check with the intent to obtain money that is not theirs or to deceive a bank employee they will usually be subject to criminal consequences these consequences can include jail time andor criminal fines',\n",
       " 'if you use a deposit atm from another bank within the network your funds may not show up in your account as quickly that is fine if you have got sufficient funds in your account but it can cause overdrafts fees and other problems if you dont',\n",
       " 'the fraudster uses the information to deposit a fake check once the deposit has been made the scammer will request funds to be immediately transferred back to them via money order person to person transfer wire transfer reloadable cards or even gift cards',\n",
       " 'if the deposited check was not the result of fraudulent activity the bank will require you to pay any fees and overdraft charges that occur on your account as a result of the check if the fees cause your account to have a negative balance and you fail to pay it the bank may close the account and report you to chexsystems',\n",
       " 'if you knowingly allow someone to deposit fraudulent money into your bank account—and the fraud is discovered—you could be charged with a crime this is one way people “launder” money depositing money into another person’s account can be seen as an attempt to remove the evidence of the real source of the money',\n",
       " 'after obtaining a victims bank account social security number and other details they may actually send a loan payment or direct deposit the victim may be asked to make an immediate good faith payment out of that money but as with the check overpayment scam the loan is fraudulent',\n",
       " 'if a person knowingly deposits a fake check with the intent to obtain money that is not theirs or to deceive a bank employee they will usually be subject to criminal consequences these consequences can include jail time andor criminal fines']"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "clean_answers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [],
   "source": [
    "#dictionary that maps each word to its number of occurences\n",
    "word2count={}\n",
    "for question in clean_questions:\n",
    "    for word in question.split():\n",
    "        if word not in word2count:\n",
    "            word2count[word]=1\n",
    "        else:\n",
    "            word2count[word]+=1\n",
    "for answer in clean_answers:\n",
    "    for word in answer.split():\n",
    "        if word not in word2count:\n",
    "            word2count[word]=1\n",
    "        else:\n",
    "            word2count[word]+=1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'$100': 1,\n",
       " '$150': 1,\n",
       " '$4000': 1,\n",
       " '$50': 1,\n",
       " '0%': 1,\n",
       " '1%': 1,\n",
       " '18': 2,\n",
       " '1980s': 1,\n",
       " '2': 1,\n",
       " '2%': 1,\n",
       " '3%': 1,\n",
       " '48': 2,\n",
       " '5': 1,\n",
       " '57': 1,\n",
       " '6%': 1,\n",
       " '72': 1,\n",
       " 'a': 120,\n",
       " 'abandoned': 2,\n",
       " 'about': 4,\n",
       " 'accept': 1,\n",
       " 'accepted': 1,\n",
       " 'access': 2,\n",
       " 'account': 44,\n",
       " 'accounting': 1,\n",
       " 'accounts': 7,\n",
       " 'account—and': 1,\n",
       " 'accumulated': 2,\n",
       " 'active': 1,\n",
       " 'activities': 1,\n",
       " 'activity': 2,\n",
       " 'actually': 1,\n",
       " 'added': 1,\n",
       " 'addition': 1,\n",
       " 'additional': 2,\n",
       " 'address': 2,\n",
       " 'advantage': 1,\n",
       " 'advantages': 1,\n",
       " 'afford': 2,\n",
       " 'after': 3,\n",
       " 'against': 3,\n",
       " 'age': 1,\n",
       " 'agency': 2,\n",
       " 'agreement': 1,\n",
       " 'airlines': 3,\n",
       " 'align': 1,\n",
       " 'all': 11,\n",
       " 'allow': 2,\n",
       " 'allows': 1,\n",
       " 'almost': 1,\n",
       " 'along': 2,\n",
       " 'also': 8,\n",
       " 'american': 1,\n",
       " 'among': 1,\n",
       " 'amount': 11,\n",
       " 'amounts': 3,\n",
       " 'an': 20,\n",
       " 'and': 69,\n",
       " 'andor': 2,\n",
       " 'annual': 8,\n",
       " 'anonymity': 1,\n",
       " 'another': 6,\n",
       " 'answer': 1,\n",
       " 'any': 6,\n",
       " 'application': 1,\n",
       " 'apply': 3,\n",
       " 'applying': 2,\n",
       " 'approval': 4,\n",
       " 'approved': 1,\n",
       " 'apr': 1,\n",
       " 'are': 34,\n",
       " 'around': 1,\n",
       " 'arrested': 1,\n",
       " 'as': 28,\n",
       " 'ask': 1,\n",
       " 'asked': 1,\n",
       " 'associated': 1,\n",
       " 'at': 5,\n",
       " 'atm': 11,\n",
       " 'atms': 1,\n",
       " 'attached': 1,\n",
       " 'attempt': 1,\n",
       " 'aunsecured': 1,\n",
       " 'authorise': 1,\n",
       " 'authorization': 1,\n",
       " 'authorized': 1,\n",
       " 'auto': 1,\n",
       " 'automated': 2,\n",
       " 'automatically': 2,\n",
       " 'autopay': 4,\n",
       " 'available': 3,\n",
       " 'avoid': 2,\n",
       " 'avoiding': 1,\n",
       " 'b': 2,\n",
       " 'back': 9,\n",
       " 'bad': 1,\n",
       " 'balance': 10,\n",
       " 'balance’': 1,\n",
       " 'bank': 34,\n",
       " 'banking': 3,\n",
       " 'banks': 11,\n",
       " 'bank’s': 2,\n",
       " 'based': 2,\n",
       " 'basic': 1,\n",
       " 'be': 21,\n",
       " 'because': 2,\n",
       " 'been': 3,\n",
       " 'before': 1,\n",
       " 'began': 1,\n",
       " 'being': 1,\n",
       " 'beneficiary': 2,\n",
       " 'benefit': 2,\n",
       " 'benefits': 2,\n",
       " 'best': 1,\n",
       " 'better': 1,\n",
       " 'between': 3,\n",
       " 'beyond': 1,\n",
       " 'bill': 1,\n",
       " 'billed': 1,\n",
       " 'billers': 1,\n",
       " 'billing': 2,\n",
       " 'bills': 2,\n",
       " 'block': 3,\n",
       " 'blocked': 2,\n",
       " 'bob': 1,\n",
       " 'bonus': 2,\n",
       " 'bookkeeping': 1,\n",
       " 'borrow': 1,\n",
       " 'both': 2,\n",
       " 'bounce': 1,\n",
       " 'bounces': 3,\n",
       " 'brains': 1,\n",
       " 'branch': 1,\n",
       " 'brings': 2,\n",
       " 'bsecured': 1,\n",
       " 'build': 1,\n",
       " 'bulky': 2,\n",
       " 'bureaus': 1,\n",
       " 'but': 9,\n",
       " 'buy': 1,\n",
       " 'by': 13,\n",
       " 'c': 2,\n",
       " 'call': 1,\n",
       " 'called': 1,\n",
       " 'can': 35,\n",
       " 'cannot': 2,\n",
       " 'can’t': 3,\n",
       " 'caps1': 1,\n",
       " 'car': 1,\n",
       " 'card': 61,\n",
       " 'cardrelated': 1,\n",
       " 'cards': 21,\n",
       " 'carry': 2,\n",
       " 'case': 2,\n",
       " 'cash': 18,\n",
       " 'cashback': 1,\n",
       " 'cashier': 1,\n",
       " 'cashier’s': 1,\n",
       " 'categories': 2,\n",
       " 'cause': 2,\n",
       " 'cd': 1,\n",
       " 'certain': 5,\n",
       " 'certificate': 1,\n",
       " 'change': 1,\n",
       " 'charge': 4,\n",
       " 'charged': 1,\n",
       " 'charges': 8,\n",
       " 'check': 40,\n",
       " 'checkbook': 2,\n",
       " 'checking': 5,\n",
       " 'checkkiting': 1,\n",
       " 'checks': 1,\n",
       " 'cheque': 4,\n",
       " 'cheques': 3,\n",
       " 'cheque’': 1,\n",
       " 'chexsystems': 2,\n",
       " 'choose': 2,\n",
       " 'circumstances': 2,\n",
       " 'citibank4': 1,\n",
       " 'claim': 1,\n",
       " 'clauses': 1,\n",
       " 'clear': 1,\n",
       " 'cleared': 1,\n",
       " 'clearing': 1,\n",
       " 'clerks': 1,\n",
       " 'click': 1,\n",
       " 'close': 1,\n",
       " 'closes': 1,\n",
       " 'cloud': 1,\n",
       " 'collected': 1,\n",
       " 'collecting': 1,\n",
       " 'collection': 1,\n",
       " 'collects': 1,\n",
       " 'come': 3,\n",
       " 'comes': 1,\n",
       " 'companys': 1,\n",
       " 'compared': 2,\n",
       " 'complete': 3,\n",
       " 'completely': 1,\n",
       " 'concept': 1,\n",
       " 'consequences': 4,\n",
       " 'consider': 1,\n",
       " 'considered': 2,\n",
       " 'consumer': 1,\n",
       " 'consumers': 1,\n",
       " 'contact': 4,\n",
       " 'convenient': 3,\n",
       " 'costs': 2,\n",
       " 'could': 3,\n",
       " 'counter': 1,\n",
       " 'course': 1,\n",
       " 'cover': 2,\n",
       " 'created': 1,\n",
       " 'credit': 55,\n",
       " 'credited': 3,\n",
       " 'crime': 1,\n",
       " 'criminal': 4,\n",
       " 'customer': 3,\n",
       " 'customerinitiated': 1,\n",
       " 'customers': 1,\n",
       " 'cutting': 1,\n",
       " 'cycle': 2,\n",
       " 'd': 2,\n",
       " 'data': 1,\n",
       " 'date': 6,\n",
       " 'dates': 1,\n",
       " 'day': 1,\n",
       " 'days': 1,\n",
       " 'deal': 1,\n",
       " 'debit': 21,\n",
       " 'debt': 2,\n",
       " 'deceive': 2,\n",
       " 'decided': 1,\n",
       " 'decrease': 1,\n",
       " 'dedit': 3,\n",
       " 'default': 1,\n",
       " 'depend': 1,\n",
       " 'depends': 1,\n",
       " 'deposit': 18,\n",
       " 'deposited': 4,\n",
       " 'depositing': 1,\n",
       " 'depositor': 1,\n",
       " 'deposits': 5,\n",
       " 'destroy': 1,\n",
       " 'details': 4,\n",
       " 'developed': 1,\n",
       " 'difference': 2,\n",
       " 'different': 4,\n",
       " 'differently': 1,\n",
       " 'difficult': 1,\n",
       " 'direct': 1,\n",
       " 'discover': 1,\n",
       " 'discovered—you': 1,\n",
       " 'displays': 1,\n",
       " 'disputes': 1,\n",
       " 'do': 16,\n",
       " 'does': 4,\n",
       " 'doesn’t': 1,\n",
       " 'domestic': 1,\n",
       " 'dont': 2,\n",
       " 'don’t': 3,\n",
       " 'down': 1,\n",
       " 'draft': 1,\n",
       " 'draw': 1,\n",
       " 'drawn': 3,\n",
       " 'due': 3,\n",
       " 'each': 5,\n",
       " 'early': 1,\n",
       " 'earn': 6,\n",
       " 'easier': 2,\n",
       " 'efficient': 1,\n",
       " 'eitherdebit': 1,\n",
       " 'elect': 1,\n",
       " 'electronic': 3,\n",
       " 'elevated': 1,\n",
       " 'eligible': 1,\n",
       " 'else': 1,\n",
       " 'email': 1,\n",
       " 'employee': 2,\n",
       " 'enable': 1,\n",
       " 'end': 1,\n",
       " 'endorsed': 1,\n",
       " 'endorsing': 1,\n",
       " 'endorsing’': 1,\n",
       " 'ensure': 1,\n",
       " 'ensures': 1,\n",
       " 'entered': 1,\n",
       " 'entryway': 2,\n",
       " 'equal': 1,\n",
       " 'error': 1,\n",
       " 'errors': 2,\n",
       " 'escheatment': 1,\n",
       " 'established': 1,\n",
       " 'etc': 1,\n",
       " 'even': 5,\n",
       " 'evidence': 1,\n",
       " 'exactly': 1,\n",
       " 'exceed': 1,\n",
       " 'excellent': 1,\n",
       " 'expensive': 1,\n",
       " 'expiration': 1,\n",
       " 'expire': 1,\n",
       " 'expires': 1,\n",
       " 'explain': 1,\n",
       " 'express': 2,\n",
       " 'extended': 1,\n",
       " 'fact': 2,\n",
       " 'fail': 1,\n",
       " 'fair': 1,\n",
       " 'faith': 1,\n",
       " 'fake': 8,\n",
       " 'far': 1,\n",
       " 'faster': 2,\n",
       " 'fee': 5,\n",
       " 'fees': 19,\n",
       " 'few': 1,\n",
       " 'fico': 1,\n",
       " 'financial': 1,\n",
       " 'find': 2,\n",
       " 'fine': 1,\n",
       " 'fines': 2,\n",
       " 'first': 4,\n",
       " 'five': 1,\n",
       " 'fixed': 2,\n",
       " 'float': 1,\n",
       " 'float”': 1,\n",
       " 'flooring': 1,\n",
       " 'flying': 1,\n",
       " 'for': 37,\n",
       " 'forehead': 1,\n",
       " 'forfeit': 1,\n",
       " 'form': 1,\n",
       " 'forming': 1,\n",
       " 'forms': 1,\n",
       " 'fraud': 5,\n",
       " 'fraudster': 2,\n",
       " 'fraudulent': 6,\n",
       " 'fraudulently': 1,\n",
       " 'free': 2,\n",
       " 'frequentflyer': 3,\n",
       " 'from': 15,\n",
       " 'full': 1,\n",
       " 'funds': 16,\n",
       " 'furthermore': 1,\n",
       " 'generally': 1,\n",
       " 'get': 5,\n",
       " 'gets': 1,\n",
       " 'giant': 1,\n",
       " 'gift': 1,\n",
       " 'gives': 1,\n",
       " 'globally': 1,\n",
       " 'go': 3,\n",
       " 'good': 4,\n",
       " 'got': 1,\n",
       " 'grace': 1,\n",
       " 'granted': 1,\n",
       " 'grew': 1,\n",
       " 'grout': 1,\n",
       " 'grouting': 1,\n",
       " 'grown': 1,\n",
       " 'guaranteed': 2,\n",
       " 'guarantees': 1,\n",
       " 'habits': 1,\n",
       " 'hand': 1,\n",
       " 'happen': 1,\n",
       " 'happens': 6,\n",
       " 'has': 7,\n",
       " 'hasnt': 1,\n",
       " 'have': 22,\n",
       " 'having': 3,\n",
       " 'help': 2,\n",
       " 'here': 1,\n",
       " 'high': 1,\n",
       " 'higher': 1,\n",
       " 'hire': 1,\n",
       " 'history': 3,\n",
       " 'hold': 2,\n",
       " 'honest': 3,\n",
       " 'hotel': 1,\n",
       " 'hours': 3,\n",
       " 'houses': 1,\n",
       " 'how': 16,\n",
       " 'however': 3,\n",
       " 'httpswwwinvestopediacomarticlespf10creditcarddebitcardasp': 1,\n",
       " 'i': 16,\n",
       " 'idea': 1,\n",
       " 'if': 33,\n",
       " 'image': 2,\n",
       " 'immediate': 1,\n",
       " 'immediately': 3,\n",
       " 'important': 1,\n",
       " 'imposed': 1,\n",
       " 'in': 35,\n",
       " 'incentives': 2,\n",
       " 'include': 4,\n",
       " 'incorrect': 1,\n",
       " 'increase': 2,\n",
       " 'increases': 1,\n",
       " 'incur': 1,\n",
       " 'independently': 1,\n",
       " 'india': 1,\n",
       " 'individual': 1,\n",
       " 'individual’s': 1,\n",
       " 'information': 5,\n",
       " 'insert': 1,\n",
       " 'inside': 1,\n",
       " 'instant': 4,\n",
       " 'instead': 2,\n",
       " 'institution’s': 1,\n",
       " 'instructed': 1,\n",
       " 'insurance': 5,\n",
       " 'intent': 2,\n",
       " 'interest': 8,\n",
       " 'international': 1,\n",
       " 'internet': 1,\n",
       " 'into': 6,\n",
       " 'introductory': 1,\n",
       " 'invoice': 1,\n",
       " 'involve': 1,\n",
       " 'involves': 1,\n",
       " 'is': 63,\n",
       " 'issue': 3,\n",
       " 'issued': 1,\n",
       " 'issuer': 5,\n",
       " 'issuers': 1,\n",
       " 'it': 28,\n",
       " 'items': 1,\n",
       " 'its': 1,\n",
       " 'it’s': 6,\n",
       " 'it”': 1,\n",
       " 'i’d': 1,\n",
       " 'jail': 2,\n",
       " 'just': 1,\n",
       " 'keep': 1,\n",
       " 'keeping': 1,\n",
       " 'keeps': 1,\n",
       " 'kind': 1,\n",
       " 'kiting': 1,\n",
       " 'know': 3,\n",
       " 'knowingly': 4,\n",
       " 'known': 1,\n",
       " 'large': 2,\n",
       " 'late': 3,\n",
       " 'later': 2,\n",
       " 'laws': 1,\n",
       " 'learn': 1,\n",
       " 'least': 1,\n",
       " 'length': 1,\n",
       " 'letting': 1,\n",
       " 'level': 1,\n",
       " 'lifestyle': 1,\n",
       " 'like': 5,\n",
       " 'limit': 3,\n",
       " 'limited': 2,\n",
       " 'linked': 1,\n",
       " 'loan': 5,\n",
       " 'loans': 3,\n",
       " 'location': 1,\n",
       " 'logging': 1,\n",
       " 'login': 1,\n",
       " 'logo': 1,\n",
       " 'long': 1,\n",
       " 'lose': 1,\n",
       " 'losses': 2,\n",
       " 'lot': 1,\n",
       " 'lower': 1,\n",
       " 'lowest': 1,\n",
       " 'loyalty': 1,\n",
       " 'lucrative': 1,\n",
       " 'machine': 1,\n",
       " 'made': 2,\n",
       " 'maiden': 1,\n",
       " 'maintain': 1,\n",
       " 'major': 1,\n",
       " 'make': 7,\n",
       " 'making': 2,\n",
       " 'manually': 1,\n",
       " 'manufacturers': 1,\n",
       " 'many': 5,\n",
       " 'market': 2,\n",
       " 'mastercard': 2,\n",
       " 'match': 1,\n",
       " 'matter': 1,\n",
       " 'matured': 1,\n",
       " 'may': 11,\n",
       " 'me': 1,\n",
       " 'mean': 2,\n",
       " 'meaning': 1,\n",
       " 'means': 3,\n",
       " 'measuring': 1,\n",
       " 'mental': 2,\n",
       " 'merchant': 2,\n",
       " 'merchants': 2,\n",
       " 'mess': 1,\n",
       " 'method': 1,\n",
       " 'methods': 1,\n",
       " 'might': 2,\n",
       " 'miles': 4,\n",
       " 'mine': 1,\n",
       " 'minimal': 1,\n",
       " 'minimizes': 1,\n",
       " 'minimum': 3,\n",
       " 'missing': 1,\n",
       " 'mobile': 4,\n",
       " 'money': 19,\n",
       " 'months': 2,\n",
       " 'more': 11,\n",
       " 'most': 3,\n",
       " 'mother’s': 1,\n",
       " 'move': 1,\n",
       " 'moved': 1,\n",
       " 'much': 3,\n",
       " 'my': 8,\n",
       " 'name': 3,\n",
       " 'narrow': 1,\n",
       " 'nature': 1,\n",
       " 'need': 11,\n",
       " 'negative': 1,\n",
       " 'netbanking': 1,\n",
       " 'network': 1,\n",
       " 'never': 2,\n",
       " 'new': 3,\n",
       " 'no': 12,\n",
       " 'normal': 1,\n",
       " 'normally': 1,\n",
       " 'not': 17,\n",
       " 'notice': 1,\n",
       " 'novel': 1,\n",
       " 'now': 5,\n",
       " 'number': 7,\n",
       " 'obtain': 2,\n",
       " 'obtaining': 1,\n",
       " 'occur': 1,\n",
       " 'of': 58,\n",
       " 'offer': 2,\n",
       " 'offered': 1,\n",
       " 'offering': 2,\n",
       " 'offers': 3,\n",
       " 'official': 1,\n",
       " 'often': 3,\n",
       " 'old': 1,\n",
       " 'on': 27,\n",
       " 'once': 2,\n",
       " 'one': 10,\n",
       " 'ones': 1,\n",
       " 'online': 7,\n",
       " 'only': 6,\n",
       " 'opened': 1,\n",
       " 'operate': 2,\n",
       " 'opt': 1,\n",
       " 'options': 1,\n",
       " 'or': 40,\n",
       " 'order': 2,\n",
       " 'other': 12,\n",
       " 'others': 2,\n",
       " 'our': 1,\n",
       " 'out': 5,\n",
       " 'over': 3,\n",
       " 'overdraft': 1,\n",
       " 'overdrafts': 1,\n",
       " 'overpayment': 2,\n",
       " 'overspend': 2,\n",
       " 'owe': 1,\n",
       " 'owning': 1,\n",
       " 'paid': 1,\n",
       " 'parents’': 1,\n",
       " 'part': 1,\n",
       " 'particularly': 1,\n",
       " 'partner': 1,\n",
       " 'partnership': 2,\n",
       " 'password': 1,\n",
       " 'pay': 9,\n",
       " 'payee': 2,\n",
       " 'paying': 5,\n",
       " 'payment': 13,\n",
       " 'payments': 9,\n",
       " 'pays': 1,\n",
       " 'people': 10,\n",
       " 'percentage': 2,\n",
       " 'period': 6,\n",
       " 'perk': 1,\n",
       " 'person': 5,\n",
       " 'personal': 5,\n",
       " 'person’s': 1,\n",
       " 'placing': 1,\n",
       " 'plan': 1,\n",
       " 'plannot': 1,\n",
       " 'plastic': 2,\n",
       " 'please': 3,\n",
       " 'plenty': 1,\n",
       " 'plus': 1,\n",
       " 'point': 2,\n",
       " 'points': 3,\n",
       " 'pointskeeping': 1,\n",
       " 'police': 1,\n",
       " 'popularized': 1,\n",
       " 'portal': 2,\n",
       " 'possible': 1,\n",
       " 'power': 1,\n",
       " 'predates': 1,\n",
       " 'primary': 1,\n",
       " 'prime': 1,\n",
       " 'prior': 1,\n",
       " 'problems': 1,\n",
       " 'process': 4,\n",
       " 'product': 1,\n",
       " 'program': 1,\n",
       " 'programs': 4,\n",
       " 'promotion': 1,\n",
       " 'prompt': 1,\n",
       " 'protection': 5,\n",
       " 'protections': 1,\n",
       " 'provide': 1,\n",
       " 'provided': 1,\n",
       " 'purchase': 6,\n",
       " 'purchases': 5,\n",
       " 'purchasing': 1,\n",
       " 'purposes': 1,\n",
       " 'put': 2,\n",
       " 'qualify': 1,\n",
       " 'quarterly': 1,\n",
       " 'query’': 1,\n",
       " 'quick': 1,\n",
       " 'quickly': 1,\n",
       " 'quite': 2,\n",
       " 'rare': 1,\n",
       " 'rate': 8,\n",
       " 'react': 1,\n",
       " 'reaction': 1,\n",
       " 'read': 1,\n",
       " 'real': 1,\n",
       " 'realize': 1,\n",
       " 'really': 1,\n",
       " 'reasons': 2,\n",
       " 'rebated': 1,\n",
       " 'receive': 1,\n",
       " 'redeem': 2,\n",
       " 'redeemed': 1,\n",
       " 'refer': 1,\n",
       " 'referring': 1,\n",
       " 'relationship': 2,\n",
       " 'reloadable': 1,\n",
       " 'remain': 1,\n",
       " 'remember': 1,\n",
       " 'remove': 1,\n",
       " 'rental': 1,\n",
       " 'report': 2,\n",
       " 'reported': 1,\n",
       " 'reports': 1,\n",
       " 'request': 1,\n",
       " 'require': 1,\n",
       " 'requires': 1,\n",
       " 'requiring': 1,\n",
       " 'resolve': 1,\n",
       " 'rest': 1,\n",
       " 'result': 2,\n",
       " 'retailers': 1,\n",
       " 'return': 1,\n",
       " 'returned': 1,\n",
       " 'returns': 1,\n",
       " 'reward': 3,\n",
       " 'rewards': 9,\n",
       " 'risk': 4,\n",
       " 'run': 1,\n",
       " 'safe': 1,\n",
       " 'same': 1,\n",
       " 'save': 1,\n",
       " 'saving': 4,\n",
       " 'savings': 4,\n",
       " 'say': 3,\n",
       " 'says': 1,\n",
       " 'scam': 2,\n",
       " 'scammer': 1,\n",
       " 'scared': 1,\n",
       " 'schedule': 1,\n",
       " 'scheduled': 2,\n",
       " 'school': 1,\n",
       " 'score': 2,\n",
       " 'scores': 1,\n",
       " 'second': 1,\n",
       " 'secondary': 1,\n",
       " 'security': 4,\n",
       " 'seen': 1,\n",
       " 'select': 2,\n",
       " 'selected': 2,\n",
       " 'send': 1,\n",
       " 'sent': 1,\n",
       " 'service': 1,\n",
       " 'set': 5,\n",
       " 'setter': 1,\n",
       " 'settle': 1,\n",
       " 'shift': 1,\n",
       " 'shop': 1,\n",
       " 'shopping': 2,\n",
       " 'should': 5,\n",
       " 'show': 1,\n",
       " 'shows': 1,\n",
       " 'sign': 1,\n",
       " 'signature': 1,\n",
       " 'signup': 1,\n",
       " 'similar': 2,\n",
       " 'simple': 3,\n",
       " 'six': 2,\n",
       " 'slot': 2,\n",
       " 'small': 2,\n",
       " 'so': 6,\n",
       " 'social': 2,\n",
       " 'sold': 1,\n",
       " 'some': 9,\n",
       " 'someone': 1,\n",
       " 'something': 1,\n",
       " 'sometimes': 1,\n",
       " 'soon': 1,\n",
       " 'sorting': 1,\n",
       " 'source': 1,\n",
       " 'spacers': 1,\n",
       " 'special': 1,\n",
       " 'specific': 2,\n",
       " 'spend': 3,\n",
       " 'spending': 3,\n",
       " 'start': 1,\n",
       " 'starts': 1,\n",
       " 'state': 1,\n",
       " 'states': 1,\n",
       " 'steps': 2,\n",
       " 'still': 2,\n",
       " 'stolen': 1,\n",
       " 'stop': 1,\n",
       " 'straightforward': 1,\n",
       " 'streamline': 1,\n",
       " 'students': 1,\n",
       " 'subject': 2,\n",
       " 'submits': 1,\n",
       " 'subscription': 1,\n",
       " 'such': 6,\n",
       " 'sufficient': 2,\n",
       " 'sure': 1,\n",
       " 'suspect': 1,\n",
       " 'take': 6,\n",
       " 'takes': 1,\n",
       " 'technical': 1,\n",
       " 'telephone': 1,\n",
       " 'teller': 1,\n",
       " 'teller’s': 1,\n",
       " 'temporary': 2,\n",
       " 'tend': 1,\n",
       " 'term': 2,\n",
       " 'than': 4,\n",
       " 'that': 29,\n",
       " 'that’s': 1,\n",
       " 'the': 162,\n",
       " 'theft': 1,\n",
       " 'their': 7,\n",
       " 'theirs': 2,\n",
       " 'them': 3,\n",
       " 'then': 3,\n",
       " 'there': 11,\n",
       " 'therefore': 1,\n",
       " 'there’s': 3,\n",
       " 'these': 7,\n",
       " 'they': 11,\n",
       " 'thing': 2,\n",
       " 'things': 1,\n",
       " 'think': 1,\n",
       " 'this': 10,\n",
       " 'those': 3,\n",
       " 'though': 3,\n",
       " 'three': 1,\n",
       " 'throbbing': 1,\n",
       " 'through': 1,\n",
       " 'tile': 2,\n",
       " 'tiles': 1,\n",
       " 'time': 8,\n",
       " 'to': 111,\n",
       " 'today': 1,\n",
       " 'top': 1,\n",
       " 'total': 1,\n",
       " 'transaction': 5,\n",
       " 'transactions': 5,\n",
       " 'transfer': 8,\n",
       " 'transferred': 1,\n",
       " 'transferring': 3,\n",
       " 'transfer”': 2,\n",
       " 'travel': 1,\n",
       " 'treated': 1,\n",
       " 'trouble': 1,\n",
       " 'troubles': 1,\n",
       " 'truth': 1,\n",
       " 'two': 3,\n",
       " 'type': 2,\n",
       " 'types': 4,\n",
       " 'typically': 5,\n",
       " 'unclaimed': 2,\n",
       " 'under': 1,\n",
       " 'understand': 2,\n",
       " 'unexpected': 1,\n",
       " 'union': 1,\n",
       " 'united': 1,\n",
       " 'unlike': 1,\n",
       " 'until': 2,\n",
       " 'up': 6,\n",
       " 'updated': 1,\n",
       " 'upon': 3,\n",
       " 'us': 3,\n",
       " 'use': 12,\n",
       " 'used': 2,\n",
       " 'users': 1,\n",
       " 'uses': 1,\n",
       " 'using': 5,\n",
       " 'usually': 9,\n",
       " 'utilising': 1,\n",
       " 'value': 2,\n",
       " 'variablerate': 1,\n",
       " 'vein': 1,\n",
       " 'venders': 1,\n",
       " 'vendors': 2,\n",
       " 'verifies': 1,\n",
       " 'verify': 1,\n",
       " 'very': 1,\n",
       " 'via': 1,\n",
       " 'victim': 1,\n",
       " 'victims': 1,\n",
       " 'video': 1,\n",
       " 'viewed': 1,\n",
       " 'visa': 2,\n",
       " 'visit': 1,\n",
       " 'volume': 1,\n",
       " 'wait': 2,\n",
       " 'want': 2,\n",
       " 'warranties': 3,\n",
       " 'warranty': 1,\n",
       " 'was': 4,\n",
       " 'way': 4,\n",
       " 'ways': 2,\n",
       " 'we': 2,\n",
       " 'website': 1,\n",
       " 'weekend': 1,\n",
       " 'well': 1,\n",
       " 'were': 2,\n",
       " 'what': 27,\n",
       " 'when': 14,\n",
       " 'whenever': 1,\n",
       " 'where': 1,\n",
       " 'whether': 1,\n",
       " 'which': 8,\n",
       " 'while': 1,\n",
       " 'who': 1,\n",
       " 'whole': 1,\n",
       " 'why': 7,\n",
       " 'will': 17,\n",
       " 'willingly': 1,\n",
       " 'wire': 2,\n",
       " 'with': 24,\n",
       " 'withdraw': 3,\n",
       " 'withdrawal': 2,\n",
       " 'withdrawn': 1,\n",
       " 'within': 2,\n",
       " 'without': 2,\n",
       " 'won’t': 1,\n",
       " 'work': 3,\n",
       " 'workers': 1,\n",
       " 'working': 1,\n",
       " 'works': 1,\n",
       " 'worry': 1,\n",
       " 'worst': 1,\n",
       " 'would': 1,\n",
       " 'write': 1,\n",
       " 'writing': 2,\n",
       " 'wrong!': 1,\n",
       " 'year': 1,\n",
       " 'years': 2,\n",
       " 'yes': 2,\n",
       " 'yes!': 1,\n",
       " 'yet': 1,\n",
       " 'you': 80,\n",
       " 'youll': 1,\n",
       " 'your': 51,\n",
       " 'you’d': 1,\n",
       " 'you’ll': 3,\n",
       " 'you’re': 2,\n",
       " '–': 1,\n",
       " '‘account': 2,\n",
       " '‘accounts’': 1,\n",
       " '‘cheque': 1,\n",
       " '‘endorsing': 1,\n",
       " '“launder”': 1,\n",
       " '“taking': 1,\n",
       " '“use': 1,\n",
       " '“wire': 2}"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "word2count"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [],
   "source": [
    "#creating 2 dictionaries tokenaization wordsin integer, filterign them if they aoccure less than threshold\n",
    "threshold=1\n",
    "questionsWord2int={}\n",
    "word_number=0\n",
    "for word, count in word2count.items():\n",
    "    if count>=threshold:\n",
    "        questionsWord2int[word]=word_number\n",
    "        word_number+=1\n",
    "        \n",
    "answersWord2int={}\n",
    "word_number=0\n",
    "for word, count in word2count.items():\n",
    "    if count>=threshold:\n",
    "        answersWord2int[word]=word_number\n",
    "        word_number+=1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'$100': 346,\n",
       " '$150': 287,\n",
       " '$4000': 301,\n",
       " '$50': 815,\n",
       " '0%': 144,\n",
       " '1%': 613,\n",
       " '18': 611,\n",
       " '1980s': 3,\n",
       " '2': 445,\n",
       " '2%': 703,\n",
       " '3%': 279,\n",
       " '48': 694,\n",
       " '5': 819,\n",
       " '57': 670,\n",
       " '6%': 237,\n",
       " '72': 492,\n",
       " 'a': 396,\n",
       " 'abandoned': 660,\n",
       " 'about': 216,\n",
       " 'accept': 254,\n",
       " 'accepted': 30,\n",
       " 'access': 109,\n",
       " 'account': 456,\n",
       " 'accounting': 570,\n",
       " 'accounts': 392,\n",
       " 'account—and': 802,\n",
       " 'accumulated': 447,\n",
       " 'active': 408,\n",
       " 'activities': 189,\n",
       " 'activity': 160,\n",
       " 'actually': 843,\n",
       " 'added': 228,\n",
       " 'addition': 866,\n",
       " 'additional': 848,\n",
       " 'address': 549,\n",
       " 'advantage': 721,\n",
       " 'advantages': 247,\n",
       " 'afford': 791,\n",
       " 'after': 839,\n",
       " 'against': 551,\n",
       " 'age': 307,\n",
       " 'agency': 557,\n",
       " 'agreement': 281,\n",
       " 'airlines': 258,\n",
       " 'align': 120,\n",
       " 'all': 619,\n",
       " 'allow': 57,\n",
       " 'allows': 97,\n",
       " 'almost': 576,\n",
       " 'along': 546,\n",
       " 'also': 241,\n",
       " 'american': 734,\n",
       " 'among': 19,\n",
       " 'amount': 750,\n",
       " 'amounts': 753,\n",
       " 'an': 797,\n",
       " 'and': 100,\n",
       " 'andor': 55,\n",
       " 'annual': 558,\n",
       " 'anonymity': 510,\n",
       " 'another': 527,\n",
       " 'answer': 428,\n",
       " 'any': 6,\n",
       " 'application': 338,\n",
       " 'apply': 433,\n",
       " 'applying': 769,\n",
       " 'approval': 526,\n",
       " 'approved': 459,\n",
       " 'apr': 770,\n",
       " 'are': 128,\n",
       " 'around': 842,\n",
       " 'arrested': 295,\n",
       " 'as': 583,\n",
       " 'ask': 496,\n",
       " 'asked': 296,\n",
       " 'associated': 44,\n",
       " 'at': 329,\n",
       " 'atm': 147,\n",
       " 'atms': 818,\n",
       " 'attached': 1,\n",
       " 'attempt': 786,\n",
       " 'aunsecured': 589,\n",
       " 'authorise': 846,\n",
       " 'authorization': 831,\n",
       " 'authorized': 285,\n",
       " 'auto': 665,\n",
       " 'automated': 45,\n",
       " 'automatically': 760,\n",
       " 'autopay': 368,\n",
       " 'available': 233,\n",
       " 'avoid': 653,\n",
       " 'avoiding': 203,\n",
       " 'b': 118,\n",
       " 'back': 53,\n",
       " 'bad': 832,\n",
       " 'balance': 17,\n",
       " 'balance’': 255,\n",
       " 'bank': 874,\n",
       " 'banking': 8,\n",
       " 'banks': 803,\n",
       " 'bank’s': 137,\n",
       " 'based': 103,\n",
       " 'basic': 220,\n",
       " 'be': 274,\n",
       " 'because': 464,\n",
       " 'been': 178,\n",
       " 'before': 515,\n",
       " 'began': 199,\n",
       " 'being': 234,\n",
       " 'beneficiary': 550,\n",
       " 'benefit': 616,\n",
       " 'benefits': 552,\n",
       " 'best': 332,\n",
       " 'better': 313,\n",
       " 'between': 239,\n",
       " 'beyond': 21,\n",
       " 'bill': 15,\n",
       " 'billed': 509,\n",
       " 'billers': 699,\n",
       " 'billing': 837,\n",
       " 'bills': 475,\n",
       " 'block': 885,\n",
       " 'blocked': 661,\n",
       " 'bob': 696,\n",
       " 'bonus': 652,\n",
       " 'bookkeeping': 500,\n",
       " 'borrow': 138,\n",
       " 'both': 634,\n",
       " 'bounce': 627,\n",
       " 'bounces': 161,\n",
       " 'brains': 516,\n",
       " 'branch': 829,\n",
       " 'brings': 314,\n",
       " 'bsecured': 84,\n",
       " 'build': 112,\n",
       " 'bulky': 840,\n",
       " 'bureaus': 27,\n",
       " 'but': 393,\n",
       " 'buy': 537,\n",
       " 'by': 421,\n",
       " 'c': 23,\n",
       " 'call': 116,\n",
       " 'called': 683,\n",
       " 'can': 190,\n",
       " 'cannot': 698,\n",
       " 'can’t': 531,\n",
       " 'caps1': 210,\n",
       " 'car': 410,\n",
       " 'card': 609,\n",
       " 'cardrelated': 706,\n",
       " 'cards': 165,\n",
       " 'carry': 833,\n",
       " 'case': 308,\n",
       " 'cash': 591,\n",
       " 'cashback': 738,\n",
       " 'cashier': 807,\n",
       " 'cashier’s': 768,\n",
       " 'categories': 486,\n",
       " 'cause': 227,\n",
       " 'cd': 640,\n",
       " 'certain': 581,\n",
       " 'certificate': 344,\n",
       " 'change': 784,\n",
       " 'charge': 729,\n",
       " 'charged': 787,\n",
       " 'charges': 538,\n",
       " 'check': 268,\n",
       " 'checkbook': 592,\n",
       " 'checking': 360,\n",
       " 'checkkiting': 345,\n",
       " 'checks': 603,\n",
       " 'cheque': 553,\n",
       " 'cheques': 621,\n",
       " 'cheque’': 521,\n",
       " 'chexsystems': 704,\n",
       " 'choose': 95,\n",
       " 'circumstances': 764,\n",
       " 'citibank4': 826,\n",
       " 'claim': 424,\n",
       " 'clauses': 130,\n",
       " 'clear': 623,\n",
       " 'cleared': 776,\n",
       " 'clearing': 686,\n",
       " 'clerks': 7,\n",
       " 'click': 371,\n",
       " 'close': 404,\n",
       " 'closes': 177,\n",
       " 'cloud': 248,\n",
       " 'collected': 244,\n",
       " 'collecting': 276,\n",
       " 'collection': 809,\n",
       " 'collects': 298,\n",
       " 'come': 817,\n",
       " 'comes': 60,\n",
       " 'companys': 208,\n",
       " 'compared': 625,\n",
       " 'complete': 571,\n",
       " 'completely': 493,\n",
       " 'concept': 559,\n",
       " 'consequences': 782,\n",
       " 'consider': 291,\n",
       " 'considered': 235,\n",
       " 'consumer': 174,\n",
       " 'consumers': 411,\n",
       " 'contact': 454,\n",
       " 'convenient': 465,\n",
       " 'costs': 29,\n",
       " 'could': 245,\n",
       " 'counter': 31,\n",
       " 'course': 292,\n",
       " 'cover': 488,\n",
       " 'created': 293,\n",
       " 'credit': 638,\n",
       " 'credited': 265,\n",
       " 'crime': 310,\n",
       " 'criminal': 399,\n",
       " 'customer': 495,\n",
       " 'customerinitiated': 32,\n",
       " 'customers': 728,\n",
       " 'cutting': 503,\n",
       " 'cycle': 451,\n",
       " 'd': 351,\n",
       " 'data': 715,\n",
       " 'date': 884,\n",
       " 'dates': 875,\n",
       " 'day': 18,\n",
       " 'days': 630,\n",
       " 'deal': 355,\n",
       " 'debit': 154,\n",
       " 'debt': 377,\n",
       " 'deceive': 242,\n",
       " 'decided': 142,\n",
       " 'decrease': 69,\n",
       " 'dedit': 681,\n",
       " 'default': 352,\n",
       " 'depend': 642,\n",
       " 'depends': 65,\n",
       " 'deposit': 664,\n",
       " 'deposited': 883,\n",
       " 'depositing': 363,\n",
       " 'depositor': 232,\n",
       " 'deposits': 746,\n",
       " 'destroy': 436,\n",
       " 'details': 272,\n",
       " 'developed': 687,\n",
       " 'difference': 606,\n",
       " 'different': 518,\n",
       " 'differently': 554,\n",
       " 'difficult': 697,\n",
       " 'direct': 825,\n",
       " 'discover': 682,\n",
       " 'discovered—you': 47,\n",
       " 'displays': 879,\n",
       " 'disputes': 42,\n",
       " 'do': 139,\n",
       " 'does': 876,\n",
       " 'doesn’t': 594,\n",
       " 'domestic': 80,\n",
       " 'dont': 727,\n",
       " 'don’t': 119,\n",
       " 'down': 427,\n",
       " 'draft': 11,\n",
       " 'draw': 539,\n",
       " 'drawn': 58,\n",
       " 'due': 749,\n",
       " 'each': 741,\n",
       " 'early': 777,\n",
       " 'earn': 785,\n",
       " 'easier': 669,\n",
       " 'efficient': 561,\n",
       " 'eitherdebit': 635,\n",
       " 'elect': 824,\n",
       " 'electronic': 412,\n",
       " 'elevated': 283,\n",
       " 'eligible': 382,\n",
       " 'else': 636,\n",
       " 'email': 691,\n",
       " 'employee': 744,\n",
       " 'enable': 353,\n",
       " 'end': 350,\n",
       " 'endorsed': 578,\n",
       " 'endorsing': 565,\n",
       " 'endorsing’': 556,\n",
       " 'ensure': 632,\n",
       " 'ensures': 215,\n",
       " 'entered': 383,\n",
       " 'entryway': 214,\n",
       " 'equal': 200,\n",
       " 'error': 423,\n",
       " 'errors': 267,\n",
       " 'escheatment': 43,\n",
       " 'established': 774,\n",
       " 'etc': 610,\n",
       " 'even': 597,\n",
       " 'evidence': 684,\n",
       " 'exactly': 800,\n",
       " 'exceed': 76,\n",
       " 'excellent': 855,\n",
       " 'expensive': 66,\n",
       " 'expiration': 22,\n",
       " 'expire': 336,\n",
       " 'expires': 629,\n",
       " 'explain': 264,\n",
       " 'express': 275,\n",
       " 'extended': 341,\n",
       " 'fact': 390,\n",
       " 'fail': 163,\n",
       " 'fair': 763,\n",
       " 'faith': 742,\n",
       " 'fake': 188,\n",
       " 'far': 430,\n",
       " 'faster': 505,\n",
       " 'fee': 575,\n",
       " 'fees': 535,\n",
       " 'few': 74,\n",
       " 'fico': 662,\n",
       " 'financial': 548,\n",
       " 'find': 422,\n",
       " 'fine': 132,\n",
       " 'fines': 337,\n",
       " 'first': 347,\n",
       " 'five': 93,\n",
       " 'fixed': 153,\n",
       " 'float': 560,\n",
       " 'float”': 813,\n",
       " 'flooring': 542,\n",
       " 'flying': 280,\n",
       " 'for': 16,\n",
       " 'forehead': 659,\n",
       " 'forfeit': 328,\n",
       " 'form': 605,\n",
       " 'forming': 601,\n",
       " 'forms': 736,\n",
       " 'fraud': 198,\n",
       " 'fraudster': 305,\n",
       " 'fraudulent': 271,\n",
       " 'fraudulently': 648,\n",
       " 'free': 256,\n",
       " 'frequentflyer': 519,\n",
       " 'from': 326,\n",
       " 'full': 494,\n",
       " 'funds': 655,\n",
       " 'furthermore': 321,\n",
       " 'generally': 490,\n",
       " 'get': 481,\n",
       " 'gets': 26,\n",
       " 'giant': 508,\n",
       " 'gift': 678,\n",
       " 'gives': 318,\n",
       " 'globally': 707,\n",
       " 'go': 685,\n",
       " 'good': 663,\n",
       " 'got': 532,\n",
       " 'grace': 754,\n",
       " 'granted': 869,\n",
       " 'grew': 312,\n",
       " 'grout': 781,\n",
       " 'grouting': 369,\n",
       " 'grown': 847,\n",
       " 'guaranteed': 720,\n",
       " 'guarantees': 716,\n",
       " 'habits': 675,\n",
       " 'hand': 375,\n",
       " 'happen': 622,\n",
       " 'happens': 646,\n",
       " 'has': 284,\n",
       " 'hasnt': 358,\n",
       " 'have': 733,\n",
       " 'having': 679,\n",
       " 'help': 778,\n",
       " 'here': 323,\n",
       " 'high': 533,\n",
       " 'higher': 197,\n",
       " 'hire': 811,\n",
       " 'history': 135,\n",
       " 'hold': 857,\n",
       " 'honest': 90,\n",
       " 'hotel': 441,\n",
       " 'hours': 340,\n",
       " 'houses': 82,\n",
       " 'how': 649,\n",
       " 'however': 517,\n",
       " 'httpswwwinvestopediacomarticlespf10creditcarddebitcardasp': 865,\n",
       " 'i': 631,\n",
       " 'idea': 94,\n",
       " 'if': 149,\n",
       " 'image': 666,\n",
       " 'immediate': 409,\n",
       " 'immediately': 587,\n",
       " 'important': 598,\n",
       " 'imposed': 133,\n",
       " 'in': 700,\n",
       " 'incentives': 458,\n",
       " 'include': 33,\n",
       " 'incorrect': 529,\n",
       " 'increase': 639,\n",
       " 'increases': 394,\n",
       " 'incur': 771,\n",
       " 'independently': 711,\n",
       " 'india': 801,\n",
       " 'individual': 718,\n",
       " 'individual’s': 731,\n",
       " 'information': 573,\n",
       " 'insert': 871,\n",
       " 'inside': 827,\n",
       " 'instant': 688,\n",
       " 'instead': 628,\n",
       " 'institution’s': 849,\n",
       " 'instructed': 213,\n",
       " 'insurance': 219,\n",
       " 'intent': 395,\n",
       " 'interest': 862,\n",
       " 'international': 854,\n",
       " 'internet': 387,\n",
       " 'into': 2,\n",
       " 'introductory': 36,\n",
       " 'invoice': 425,\n",
       " 'involve': 880,\n",
       " 'involves': 334,\n",
       " 'is': 834,\n",
       " 'issue': 99,\n",
       " 'issued': 129,\n",
       " 'issuer': 588,\n",
       " 'issuers': 372,\n",
       " 'it': 131,\n",
       " 'items': 860,\n",
       " 'its': 756,\n",
       " 'it’s': 814,\n",
       " 'it”': 335,\n",
       " 'i’d': 867,\n",
       " 'jail': 46,\n",
       " 'just': 798,\n",
       " 'keep': 324,\n",
       " 'keeping': 522,\n",
       " 'keeps': 257,\n",
       " 'kind': 325,\n",
       " 'kiting': 212,\n",
       " 'know': 872,\n",
       " 'knowingly': 431,\n",
       " 'known': 577,\n",
       " 'large': 327,\n",
       " 'late': 374,\n",
       " 'later': 449,\n",
       " 'laws': 812,\n",
       " 'learn': 185,\n",
       " 'least': 514,\n",
       " 'length': 506,\n",
       " 'letting': 159,\n",
       " 'level': 333,\n",
       " 'lifestyle': 859,\n",
       " 'like': 12,\n",
       " 'limit': 667,\n",
       " 'limited': 330,\n",
       " 'linked': 230,\n",
       " 'loan': 339,\n",
       " 'loans': 263,\n",
       " 'location': 479,\n",
       " 'logging': 231,\n",
       " 'login': 54,\n",
       " 'logo': 719,\n",
       " 'long': 50,\n",
       " 'lose': 644,\n",
       " 'losses': 156,\n",
       " 'lot': 79,\n",
       " 'lower': 757,\n",
       " 'lowest': 702,\n",
       " 'loyalty': 195,\n",
       " 'lucrative': 671,\n",
       " 'machine': 41,\n",
       " 'made': 726,\n",
       " 'maiden': 838,\n",
       " 'maintain': 20,\n",
       " 'major': 317,\n",
       " 'make': 143,\n",
       " 'making': 223,\n",
       " 'manually': 24,\n",
       " 'manufacturers': 402,\n",
       " 'many': 136,\n",
       " 'market': 364,\n",
       " 'mastercard': 124,\n",
       " 'match': 140,\n",
       " 'matter': 342,\n",
       " 'matured': 752,\n",
       " 'may': 469,\n",
       " 'me': 418,\n",
       " 'mean': 882,\n",
       " 'meaning': 593,\n",
       " 'means': 359,\n",
       " 'measuring': 349,\n",
       " 'mental': 586,\n",
       " 'merchant': 384,\n",
       " 'merchants': 106,\n",
       " 'mess': 501,\n",
       " 'method': 856,\n",
       " 'methods': 693,\n",
       " 'might': 63,\n",
       " 'miles': 10,\n",
       " 'mine': 476,\n",
       " 'minimal': 72,\n",
       " 'minimizes': 373,\n",
       " 'minimum': 484,\n",
       " 'missing': 78,\n",
       " 'mobile': 173,\n",
       " 'money': 512,\n",
       " 'months': 388,\n",
       " 'more': 35,\n",
       " 'most': 306,\n",
       " 'mother’s': 772,\n",
       " 'move': 164,\n",
       " 'moved': 568,\n",
       " 'much': 735,\n",
       " 'my': 765,\n",
       " 'name': 499,\n",
       " 'narrow': 822,\n",
       " 'nature': 85,\n",
       " 'need': 236,\n",
       " 'negative': 0,\n",
       " 'netbanking': 193,\n",
       " 'network': 602,\n",
       " 'never': 482,\n",
       " 'new': 201,\n",
       " 'no': 470,\n",
       " 'normal': 540,\n",
       " 'normally': 453,\n",
       " 'not': 709,\n",
       " 'notice': 710,\n",
       " 'novel': 717,\n",
       " 'now': 192,\n",
       " 'number': 676,\n",
       " 'obtain': 105,\n",
       " 'obtaining': 438,\n",
       " 'occur': 224,\n",
       " 'of': 380,\n",
       " 'offer': 491,\n",
       " 'offered': 322,\n",
       " 'offering': 562,\n",
       " 'offers': 878,\n",
       " 'official': 863,\n",
       " 'often': 868,\n",
       " 'old': 405,\n",
       " 'on': 251,\n",
       " 'once': 795,\n",
       " 'one': 599,\n",
       " 'ones': 49,\n",
       " 'online': 541,\n",
       " 'only': 607,\n",
       " 'opened': 13,\n",
       " 'operate': 830,\n",
       " 'opt': 743,\n",
       " 'options': 92,\n",
       " 'or': 502,\n",
       " 'order': 614,\n",
       " 'other': 354,\n",
       " 'others': 81,\n",
       " 'our': 365,\n",
       " 'out': 473,\n",
       " 'over': 808,\n",
       " 'overdraft': 171,\n",
       " 'overdrafts': 181,\n",
       " 'overpayment': 367,\n",
       " 'overspend': 545,\n",
       " 'owe': 378,\n",
       " 'owning': 474,\n",
       " 'paid': 331,\n",
       " 'parents’': 471,\n",
       " 'part': 34,\n",
       " 'particularly': 792,\n",
       " 'partner': 657,\n",
       " 'partnership': 115,\n",
       " 'password': 555,\n",
       " 'pay': 624,\n",
       " 'payee': 677,\n",
       " 'paying': 250,\n",
       " 'payment': 376,\n",
       " 'payments': 37,\n",
       " 'pays': 179,\n",
       " 'people': 820,\n",
       " 'percentage': 547,\n",
       " 'period': 184,\n",
       " 'perk': 647,\n",
       " 'person': 590,\n",
       " 'personal': 155,\n",
       " 'person’s': 724,\n",
       " 'placing': 747,\n",
       " 'plan': 805,\n",
       " 'plannot': 186,\n",
       " 'plastic': 563,\n",
       " 'please': 525,\n",
       " 'plenty': 851,\n",
       " 'plus': 225,\n",
       " 'point': 126,\n",
       " 'points': 357,\n",
       " 'pointskeeping': 259,\n",
       " 'police': 783,\n",
       " 'popularized': 122,\n",
       " 'portal': 28,\n",
       " 'possible': 543,\n",
       " 'power': 398,\n",
       " 'predates': 440,\n",
       " 'primary': 413,\n",
       " 'prime': 386,\n",
       " 'prior': 14,\n",
       " 'problems': 852,\n",
       " 'process': 86,\n",
       " 'product': 656,\n",
       " 'program': 714,\n",
       " 'programs': 432,\n",
       " 'promotion': 389,\n",
       " 'prompt': 582,\n",
       " 'protection': 796,\n",
       " 'protections': 150,\n",
       " 'provide': 75,\n",
       " 'provided': 294,\n",
       " 'purchase': 77,\n",
       " 'purchases': 183,\n",
       " 'purchasing': 674,\n",
       " 'purposes': 450,\n",
       " 'put': 114,\n",
       " 'qualify': 442,\n",
       " 'quarterly': 316,\n",
       " 'query’': 226,\n",
       " 'quick': 841,\n",
       " 'quickly': 779,\n",
       " 'quite': 468,\n",
       " 'rare': 205,\n",
       " 'rate': 108,\n",
       " 'react': 278,\n",
       " 'reaction': 162,\n",
       " 'read': 513,\n",
       " 'real': 414,\n",
       " 'realize': 732,\n",
       " 'really': 835,\n",
       " 'reasons': 152,\n",
       " 'rebated': 461,\n",
       " 'receive': 692,\n",
       " 'redeem': 799,\n",
       " 'redeemed': 762,\n",
       " 'refer': 595,\n",
       " 'referring': 478,\n",
       " 'relationship': 536,\n",
       " 'reloadable': 881,\n",
       " 'remain': 127,\n",
       " 'remember': 406,\n",
       " 'remove': 858,\n",
       " 'rental': 650,\n",
       " 'report': 566,\n",
       " 'reported': 463,\n",
       " 'reports': 67,\n",
       " 'request': 89,\n",
       " 'require': 356,\n",
       " 'requires': 320,\n",
       " 'requiring': 123,\n",
       " 'resolve': 617,\n",
       " 'rest': 290,\n",
       " 'result': 48,\n",
       " 'retailers': 4,\n",
       " 'return': 157,\n",
       " 'returned': 466,\n",
       " 'returns': 615,\n",
       " 'reward': 806,\n",
       " 'rewards': 845,\n",
       " 'risk': 110,\n",
       " 'run': 530,\n",
       " 'safe': 637,\n",
       " 'same': 64,\n",
       " 'save': 828,\n",
       " 'saving': 887,\n",
       " 'savings': 261,\n",
       " 'say': 877,\n",
       " 'says': 172,\n",
       " 'scam': 180,\n",
       " 'scammer': 740,\n",
       " 'scared': 204,\n",
       " 'schedule': 202,\n",
       " 'scheduled': 480,\n",
       " 'school': 91,\n",
       " 'score': 572,\n",
       " 'scores': 645,\n",
       " 'second': 83,\n",
       " 'secondary': 61,\n",
       " 'security': 596,\n",
       " 'seen': 5,\n",
       " 'select': 455,\n",
       " 'selected': 443,\n",
       " 'send': 853,\n",
       " 'sent': 680,\n",
       " 'service': 348,\n",
       " 'set': 417,\n",
       " 'setter': 672,\n",
       " 'settle': 52,\n",
       " 'shift': 243,\n",
       " 'shop': 658,\n",
       " 'shopping': 217,\n",
       " 'should': 673,\n",
       " 'show': 25,\n",
       " 'shows': 780,\n",
       " 'sign': 297,\n",
       " 'signature': 362,\n",
       " 'signup': 773,\n",
       " 'similar': 361,\n",
       " 'simple': 221,\n",
       " 'six': 821,\n",
       " 'slot': 366,\n",
       " 'small': 810,\n",
       " 'so': 107,\n",
       " 'social': 170,\n",
       " 'sold': 816,\n",
       " 'some': 246,\n",
       " 'someone': 483,\n",
       " 'something': 416,\n",
       " 'sometimes': 209,\n",
       " 'soon': 191,\n",
       " 'sorting': 435,\n",
       " 'source': 437,\n",
       " 'spacers': 439,\n",
       " 'special': 419,\n",
       " 'specific': 788,\n",
       " 'spend': 487,\n",
       " 'spending': 266,\n",
       " 'start': 151,\n",
       " 'starts': 748,\n",
       " 'state': 277,\n",
       " 'states': 761,\n",
       " 'steps': 452,\n",
       " 'still': 850,\n",
       " 'stolen': 429,\n",
       " 'stop': 574,\n",
       " 'straightforward': 758,\n",
       " 'streamline': 385,\n",
       " 'students': 448,\n",
       " 'subject': 789,\n",
       " 'submits': 462,\n",
       " 'subscription': 426,\n",
       " 'such': 71,\n",
       " 'sufficient': 98,\n",
       " 'sure': 722,\n",
       " 'suspect': 62,\n",
       " 'take': 585,\n",
       " 'takes': 520,\n",
       " 'technical': 886,\n",
       " 'telephone': 39,\n",
       " 'teller': 211,\n",
       " 'teller’s': 498,\n",
       " 'temporary': 504,\n",
       " 'tend': 511,\n",
       " 'term': 420,\n",
       " 'than': 253,\n",
       " 'that': 767,\n",
       " 'that’s': 238,\n",
       " 'the': 579,\n",
       " 'theft': 286,\n",
       " 'their': 134,\n",
       " 'theirs': 309,\n",
       " 'them': 87,\n",
       " 'then': 651,\n",
       " 'there': 40,\n",
       " 'therefore': 299,\n",
       " 'there’s': 861,\n",
       " 'these': 790,\n",
       " 'they': 260,\n",
       " 'thing': 218,\n",
       " 'things': 379,\n",
       " 'think': 88,\n",
       " 'this': 643,\n",
       " 'those': 523,\n",
       " 'though': 269,\n",
       " 'three': 873,\n",
       " 'throbbing': 229,\n",
       " 'through': 207,\n",
       " 'tile': 59,\n",
       " 'tiles': 187,\n",
       " 'time': 737,\n",
       " 'to': 289,\n",
       " 'today': 870,\n",
       " 'top': 472,\n",
       " 'total': 176,\n",
       " 'transaction': 497,\n",
       " 'transactions': 689,\n",
       " 'transfer': 196,\n",
       " 'transferred': 273,\n",
       " 'transferring': 580,\n",
       " 'transfer”': 401,\n",
       " 'travel': 270,\n",
       " 'treated': 534,\n",
       " 'trouble': 415,\n",
       " 'troubles': 745,\n",
       " 'truth': 730,\n",
       " 'two': 303,\n",
       " 'type': 604,\n",
       " 'types': 96,\n",
       " 'typically': 282,\n",
       " 'unclaimed': 654,\n",
       " 'under': 701,\n",
       " 'understand': 600,\n",
       " 'unexpected': 249,\n",
       " 'union': 302,\n",
       " 'united': 524,\n",
       " 'unlike': 240,\n",
       " 'until': 612,\n",
       " 'up': 304,\n",
       " 'updated': 766,\n",
       " 'upon': 288,\n",
       " 'us': 175,\n",
       " 'use': 166,\n",
       " 'used': 544,\n",
       " 'users': 712,\n",
       " 'uses': 111,\n",
       " 'using': 608,\n",
       " 'usually': 343,\n",
       " 'utilising': 101,\n",
       " 'value': 633,\n",
       " 'variablerate': 391,\n",
       " 'vein': 73,\n",
       " 'venders': 725,\n",
       " 'vendors': 713,\n",
       " 'verifies': 457,\n",
       " 'verify': 194,\n",
       " 'very': 690,\n",
       " 'via': 708,\n",
       " 'victim': 222,\n",
       " 'victims': 403,\n",
       " 'video': 567,\n",
       " 'viewed': 125,\n",
       " 'visa': 446,\n",
       " 'visit': 695,\n",
       " 'volume': 167,\n",
       " 'wait': 823,\n",
       " 'want': 104,\n",
       " 'warranties': 755,\n",
       " 'warranty': 804,\n",
       " 'was': 252,\n",
       " 'way': 148,\n",
       " 'ways': 56,\n",
       " 'we': 158,\n",
       " 'website': 836,\n",
       " 'weekend': 102,\n",
       " 'well': 584,\n",
       " 'were': 739,\n",
       " 'what': 775,\n",
       " 'when': 759,\n",
       " 'whenever': 477,\n",
       " 'where': 121,\n",
       " 'whether': 618,\n",
       " 'which': 564,\n",
       " 'while': 641,\n",
       " 'who': 467,\n",
       " 'whole': 262,\n",
       " 'why': 507,\n",
       " 'will': 68,\n",
       " 'willingly': 113,\n",
       " 'wire': 206,\n",
       " 'with': 489,\n",
       " 'withdraw': 444,\n",
       " 'withdrawal': 311,\n",
       " 'withdrawn': 169,\n",
       " 'within': 145,\n",
       " 'without': 319,\n",
       " 'won’t': 381,\n",
       " 'work': 793,\n",
       " 'workers': 485,\n",
       " 'working': 705,\n",
       " 'works': 70,\n",
       " 'worry': 397,\n",
       " 'worst': 864,\n",
       " 'would': 620,\n",
       " 'write': 168,\n",
       " 'writing': 723,\n",
       " 'wrong!': 400,\n",
       " 'year': 434,\n",
       " 'years': 460,\n",
       " 'yes': 528,\n",
       " 'yes!': 315,\n",
       " 'yet': 51,\n",
       " 'you': 751,\n",
       " 'youll': 146,\n",
       " 'your': 844,\n",
       " 'you’d': 38,\n",
       " 'you’ll': 9,\n",
       " 'you’re': 370,\n",
       " '–': 407,\n",
       " '‘account': 794,\n",
       " '‘accounts’': 141,\n",
       " '‘cheque': 117,\n",
       " '‘endorsing': 626,\n",
       " '“launder”': 182,\n",
       " '“taking': 300,\n",
       " '“use': 569,\n",
       " '“wire': 668}"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "questionsWord2int"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "tokens=['<PAD>','<EOS>','<OUT>','<SOS>']\n",
    "for token in tokens:\n",
    "    questionsWord2int[token]=len(questionsWord2int)+1\n",
    "for token in tokens:\n",
    "    answersWord2int[token]=len(answersWord2int)+1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [],
   "source": [
    "answersint2word={value:key for key,value in answersWord2int.items()}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{0: 'negative',\n",
       " 1: 'attached',\n",
       " 2: 'into',\n",
       " 3: '1980s',\n",
       " 4: 'retailers',\n",
       " 5: 'seen',\n",
       " 6: 'any',\n",
       " 7: 'clerks',\n",
       " 8: 'banking',\n",
       " 9: 'you’ll',\n",
       " 10: 'miles',\n",
       " 11: 'draft',\n",
       " 12: 'like',\n",
       " 13: 'opened',\n",
       " 14: 'prior',\n",
       " 15: 'bill',\n",
       " 16: 'for',\n",
       " 17: 'balance',\n",
       " 18: 'day',\n",
       " 19: 'among',\n",
       " 20: 'maintain',\n",
       " 21: 'beyond',\n",
       " 22: 'expiration',\n",
       " 23: 'c',\n",
       " 24: 'manually',\n",
       " 25: 'show',\n",
       " 26: 'gets',\n",
       " 27: 'bureaus',\n",
       " 28: 'portal',\n",
       " 29: 'costs',\n",
       " 30: 'accepted',\n",
       " 31: 'counter',\n",
       " 32: 'customerinitiated',\n",
       " 33: 'include',\n",
       " 34: 'part',\n",
       " 35: 'more',\n",
       " 36: 'introductory',\n",
       " 37: 'payments',\n",
       " 38: 'you’d',\n",
       " 39: 'telephone',\n",
       " 40: 'there',\n",
       " 41: 'machine',\n",
       " 42: 'disputes',\n",
       " 43: 'escheatment',\n",
       " 44: 'associated',\n",
       " 45: 'automated',\n",
       " 46: 'jail',\n",
       " 47: 'discovered—you',\n",
       " 48: 'result',\n",
       " 49: 'ones',\n",
       " 50: 'long',\n",
       " 51: 'yet',\n",
       " 52: 'settle',\n",
       " 53: 'back',\n",
       " 54: 'login',\n",
       " 55: 'andor',\n",
       " 56: 'ways',\n",
       " 57: 'allow',\n",
       " 58: 'drawn',\n",
       " 59: 'tile',\n",
       " 60: 'comes',\n",
       " 61: 'secondary',\n",
       " 62: 'suspect',\n",
       " 63: 'might',\n",
       " 64: 'same',\n",
       " 65: 'depends',\n",
       " 66: 'expensive',\n",
       " 67: 'reports',\n",
       " 68: 'will',\n",
       " 69: 'decrease',\n",
       " 70: 'works',\n",
       " 71: 'such',\n",
       " 72: 'minimal',\n",
       " 73: 'vein',\n",
       " 74: 'few',\n",
       " 75: 'provide',\n",
       " 76: 'exceed',\n",
       " 77: 'purchase',\n",
       " 78: 'missing',\n",
       " 79: 'lot',\n",
       " 80: 'domestic',\n",
       " 81: 'others',\n",
       " 82: 'houses',\n",
       " 83: 'second',\n",
       " 84: 'bsecured',\n",
       " 85: 'nature',\n",
       " 86: 'process',\n",
       " 87: 'them',\n",
       " 88: 'think',\n",
       " 89: 'request',\n",
       " 90: 'honest',\n",
       " 91: 'school',\n",
       " 92: 'options',\n",
       " 93: 'five',\n",
       " 94: 'idea',\n",
       " 95: 'choose',\n",
       " 96: 'types',\n",
       " 97: 'allows',\n",
       " 98: 'sufficient',\n",
       " 99: 'issue',\n",
       " 100: 'and',\n",
       " 101: 'utilising',\n",
       " 102: 'weekend',\n",
       " 103: 'based',\n",
       " 104: 'want',\n",
       " 105: 'obtain',\n",
       " 106: 'merchants',\n",
       " 107: 'so',\n",
       " 108: 'rate',\n",
       " 109: 'access',\n",
       " 110: 'risk',\n",
       " 111: 'uses',\n",
       " 112: 'build',\n",
       " 113: 'willingly',\n",
       " 114: 'put',\n",
       " 115: 'partnership',\n",
       " 116: 'call',\n",
       " 117: '‘cheque',\n",
       " 118: 'b',\n",
       " 119: 'don’t',\n",
       " 120: 'align',\n",
       " 121: 'where',\n",
       " 122: 'popularized',\n",
       " 123: 'requiring',\n",
       " 124: 'mastercard',\n",
       " 125: 'viewed',\n",
       " 126: 'point',\n",
       " 127: 'remain',\n",
       " 128: 'are',\n",
       " 129: 'issued',\n",
       " 130: 'clauses',\n",
       " 131: 'it',\n",
       " 132: 'fine',\n",
       " 133: 'imposed',\n",
       " 134: 'their',\n",
       " 135: 'history',\n",
       " 136: 'many',\n",
       " 137: 'bank’s',\n",
       " 138: 'borrow',\n",
       " 139: 'do',\n",
       " 140: 'match',\n",
       " 141: '‘accounts’',\n",
       " 142: 'decided',\n",
       " 143: 'make',\n",
       " 144: '0%',\n",
       " 145: 'within',\n",
       " 146: 'youll',\n",
       " 147: 'atm',\n",
       " 148: 'way',\n",
       " 149: 'if',\n",
       " 150: 'protections',\n",
       " 151: 'start',\n",
       " 152: 'reasons',\n",
       " 153: 'fixed',\n",
       " 154: 'debit',\n",
       " 155: 'personal',\n",
       " 156: 'losses',\n",
       " 157: 'return',\n",
       " 158: 'we',\n",
       " 159: 'letting',\n",
       " 160: 'activity',\n",
       " 161: 'bounces',\n",
       " 162: 'reaction',\n",
       " 163: 'fail',\n",
       " 164: 'move',\n",
       " 165: 'cards',\n",
       " 166: 'use',\n",
       " 167: 'volume',\n",
       " 168: 'write',\n",
       " 169: 'withdrawn',\n",
       " 170: 'social',\n",
       " 171: 'overdraft',\n",
       " 172: 'says',\n",
       " 173: 'mobile',\n",
       " 174: 'consumer',\n",
       " 175: 'us',\n",
       " 176: 'total',\n",
       " 177: 'closes',\n",
       " 178: 'been',\n",
       " 179: 'pays',\n",
       " 180: 'scam',\n",
       " 181: 'overdrafts',\n",
       " 182: '“launder”',\n",
       " 183: 'purchases',\n",
       " 184: 'period',\n",
       " 185: 'learn',\n",
       " 186: 'plannot',\n",
       " 187: 'tiles',\n",
       " 188: 'fake',\n",
       " 189: 'activities',\n",
       " 190: 'can',\n",
       " 191: 'soon',\n",
       " 192: 'now',\n",
       " 193: 'netbanking',\n",
       " 194: 'verify',\n",
       " 195: 'loyalty',\n",
       " 196: 'transfer',\n",
       " 197: 'higher',\n",
       " 198: 'fraud',\n",
       " 199: 'began',\n",
       " 200: 'equal',\n",
       " 201: 'new',\n",
       " 202: 'schedule',\n",
       " 203: 'avoiding',\n",
       " 204: 'scared',\n",
       " 205: 'rare',\n",
       " 206: 'wire',\n",
       " 207: 'through',\n",
       " 208: 'companys',\n",
       " 209: 'sometimes',\n",
       " 210: 'caps1',\n",
       " 211: 'teller',\n",
       " 212: 'kiting',\n",
       " 213: 'instructed',\n",
       " 214: 'entryway',\n",
       " 215: 'ensures',\n",
       " 216: 'about',\n",
       " 217: 'shopping',\n",
       " 218: 'thing',\n",
       " 219: 'insurance',\n",
       " 220: 'basic',\n",
       " 221: 'simple',\n",
       " 222: 'victim',\n",
       " 223: 'making',\n",
       " 224: 'occur',\n",
       " 225: 'plus',\n",
       " 226: 'query’',\n",
       " 227: 'cause',\n",
       " 228: 'added',\n",
       " 229: 'throbbing',\n",
       " 230: 'linked',\n",
       " 231: 'logging',\n",
       " 232: 'depositor',\n",
       " 233: 'available',\n",
       " 234: 'being',\n",
       " 235: 'considered',\n",
       " 236: 'need',\n",
       " 237: '6%',\n",
       " 238: 'that’s',\n",
       " 239: 'between',\n",
       " 240: 'unlike',\n",
       " 241: 'also',\n",
       " 242: 'deceive',\n",
       " 243: 'shift',\n",
       " 244: 'collected',\n",
       " 245: 'could',\n",
       " 246: 'some',\n",
       " 247: 'advantages',\n",
       " 248: 'cloud',\n",
       " 249: 'unexpected',\n",
       " 250: 'paying',\n",
       " 251: 'on',\n",
       " 252: 'was',\n",
       " 253: 'than',\n",
       " 254: 'accept',\n",
       " 255: 'balance’',\n",
       " 256: 'free',\n",
       " 257: 'keeps',\n",
       " 258: 'airlines',\n",
       " 259: 'pointskeeping',\n",
       " 260: 'they',\n",
       " 261: 'savings',\n",
       " 262: 'whole',\n",
       " 263: 'loans',\n",
       " 264: 'explain',\n",
       " 265: 'credited',\n",
       " 266: 'spending',\n",
       " 267: 'errors',\n",
       " 268: 'check',\n",
       " 269: 'though',\n",
       " 270: 'travel',\n",
       " 271: 'fraudulent',\n",
       " 272: 'details',\n",
       " 273: 'transferred',\n",
       " 274: 'be',\n",
       " 275: 'express',\n",
       " 276: 'collecting',\n",
       " 277: 'state',\n",
       " 278: 'react',\n",
       " 279: '3%',\n",
       " 280: 'flying',\n",
       " 281: 'agreement',\n",
       " 282: 'typically',\n",
       " 283: 'elevated',\n",
       " 284: 'has',\n",
       " 285: 'authorized',\n",
       " 286: 'theft',\n",
       " 287: '$150',\n",
       " 288: 'upon',\n",
       " 289: 'to',\n",
       " 290: 'rest',\n",
       " 291: 'consider',\n",
       " 292: 'course',\n",
       " 293: 'created',\n",
       " 294: 'provided',\n",
       " 295: 'arrested',\n",
       " 296: 'asked',\n",
       " 297: 'sign',\n",
       " 298: 'collects',\n",
       " 299: 'therefore',\n",
       " 300: '“taking',\n",
       " 301: '$4000',\n",
       " 302: 'union',\n",
       " 303: 'two',\n",
       " 304: 'up',\n",
       " 305: 'fraudster',\n",
       " 306: 'most',\n",
       " 307: 'age',\n",
       " 308: 'case',\n",
       " 309: 'theirs',\n",
       " 310: 'crime',\n",
       " 311: 'withdrawal',\n",
       " 312: 'grew',\n",
       " 313: 'better',\n",
       " 314: 'brings',\n",
       " 315: 'yes!',\n",
       " 316: 'quarterly',\n",
       " 317: 'major',\n",
       " 318: 'gives',\n",
       " 319: 'without',\n",
       " 320: 'requires',\n",
       " 321: 'furthermore',\n",
       " 322: 'offered',\n",
       " 323: 'here',\n",
       " 324: 'keep',\n",
       " 325: 'kind',\n",
       " 326: 'from',\n",
       " 327: 'large',\n",
       " 328: 'forfeit',\n",
       " 329: 'at',\n",
       " 330: 'limited',\n",
       " 331: 'paid',\n",
       " 332: 'best',\n",
       " 333: 'level',\n",
       " 334: 'involves',\n",
       " 335: 'it”',\n",
       " 336: 'expire',\n",
       " 337: 'fines',\n",
       " 338: 'application',\n",
       " 339: 'loan',\n",
       " 340: 'hours',\n",
       " 341: 'extended',\n",
       " 342: 'matter',\n",
       " 343: 'usually',\n",
       " 344: 'certificate',\n",
       " 345: 'checkkiting',\n",
       " 346: '$100',\n",
       " 347: 'first',\n",
       " 348: 'service',\n",
       " 349: 'measuring',\n",
       " 350: 'end',\n",
       " 351: 'd',\n",
       " 352: 'default',\n",
       " 353: 'enable',\n",
       " 354: 'other',\n",
       " 355: 'deal',\n",
       " 356: 'require',\n",
       " 357: 'points',\n",
       " 358: 'hasnt',\n",
       " 359: 'means',\n",
       " 360: 'checking',\n",
       " 361: 'similar',\n",
       " 362: 'signature',\n",
       " 363: 'depositing',\n",
       " 364: 'market',\n",
       " 365: 'our',\n",
       " 366: 'slot',\n",
       " 367: 'overpayment',\n",
       " 368: 'autopay',\n",
       " 369: 'grouting',\n",
       " 370: 'you’re',\n",
       " 371: 'click',\n",
       " 372: 'issuers',\n",
       " 373: 'minimizes',\n",
       " 374: 'late',\n",
       " 375: 'hand',\n",
       " 376: 'payment',\n",
       " 377: 'debt',\n",
       " 378: 'owe',\n",
       " 379: 'things',\n",
       " 380: 'of',\n",
       " 381: 'won’t',\n",
       " 382: 'eligible',\n",
       " 383: 'entered',\n",
       " 384: 'merchant',\n",
       " 385: 'streamline',\n",
       " 386: 'prime',\n",
       " 387: 'internet',\n",
       " 388: 'months',\n",
       " 389: 'promotion',\n",
       " 390: 'fact',\n",
       " 391: 'variablerate',\n",
       " 392: 'accounts',\n",
       " 393: 'but',\n",
       " 394: 'increases',\n",
       " 395: 'intent',\n",
       " 396: 'a',\n",
       " 397: 'worry',\n",
       " 398: 'power',\n",
       " 399: 'criminal',\n",
       " 400: 'wrong!',\n",
       " 401: 'transfer”',\n",
       " 402: 'manufacturers',\n",
       " 403: 'victims',\n",
       " 404: 'close',\n",
       " 405: 'old',\n",
       " 406: 'remember',\n",
       " 407: '–',\n",
       " 408: 'active',\n",
       " 409: 'immediate',\n",
       " 410: 'car',\n",
       " 411: 'consumers',\n",
       " 412: 'electronic',\n",
       " 413: 'primary',\n",
       " 414: 'real',\n",
       " 415: 'trouble',\n",
       " 416: 'something',\n",
       " 417: 'set',\n",
       " 418: 'me',\n",
       " 419: 'special',\n",
       " 420: 'term',\n",
       " 421: 'by',\n",
       " 422: 'find',\n",
       " 423: 'error',\n",
       " 424: 'claim',\n",
       " 425: 'invoice',\n",
       " 426: 'subscription',\n",
       " 427: 'down',\n",
       " 428: 'answer',\n",
       " 429: 'stolen',\n",
       " 430: 'far',\n",
       " 431: 'knowingly',\n",
       " 432: 'programs',\n",
       " 433: 'apply',\n",
       " 434: 'year',\n",
       " 435: 'sorting',\n",
       " 436: 'destroy',\n",
       " 437: 'source',\n",
       " 438: 'obtaining',\n",
       " 439: 'spacers',\n",
       " 440: 'predates',\n",
       " 441: 'hotel',\n",
       " 442: 'qualify',\n",
       " 443: 'selected',\n",
       " 444: 'withdraw',\n",
       " 445: '2',\n",
       " 446: 'visa',\n",
       " 447: 'accumulated',\n",
       " 448: 'students',\n",
       " 449: 'later',\n",
       " 450: 'purposes',\n",
       " 451: 'cycle',\n",
       " 452: 'steps',\n",
       " 453: 'normally',\n",
       " 454: 'contact',\n",
       " 455: 'select',\n",
       " 456: 'account',\n",
       " 457: 'verifies',\n",
       " 458: 'incentives',\n",
       " 459: 'approved',\n",
       " 460: 'years',\n",
       " 461: 'rebated',\n",
       " 462: 'submits',\n",
       " 463: 'reported',\n",
       " 464: 'because',\n",
       " 465: 'convenient',\n",
       " 466: 'returned',\n",
       " 467: 'who',\n",
       " 468: 'quite',\n",
       " 469: 'may',\n",
       " 470: 'no',\n",
       " 471: 'parents’',\n",
       " 472: 'top',\n",
       " 473: 'out',\n",
       " 474: 'owning',\n",
       " 475: 'bills',\n",
       " 476: 'mine',\n",
       " 477: 'whenever',\n",
       " 478: 'referring',\n",
       " 479: 'location',\n",
       " 480: 'scheduled',\n",
       " 481: 'get',\n",
       " 482: 'never',\n",
       " 483: 'someone',\n",
       " 484: 'minimum',\n",
       " 485: 'workers',\n",
       " 486: 'categories',\n",
       " 487: 'spend',\n",
       " 488: 'cover',\n",
       " 489: 'with',\n",
       " 490: 'generally',\n",
       " 491: 'offer',\n",
       " 492: '72',\n",
       " 493: 'completely',\n",
       " 494: 'full',\n",
       " 495: 'customer',\n",
       " 496: 'ask',\n",
       " 497: 'transaction',\n",
       " 498: 'teller’s',\n",
       " 499: 'name',\n",
       " 500: 'bookkeeping',\n",
       " 501: 'mess',\n",
       " 502: 'or',\n",
       " 503: 'cutting',\n",
       " 504: 'temporary',\n",
       " 505: 'faster',\n",
       " 506: 'length',\n",
       " 507: 'why',\n",
       " 508: 'giant',\n",
       " 509: 'billed',\n",
       " 510: 'anonymity',\n",
       " 511: 'tend',\n",
       " 512: 'money',\n",
       " 513: 'read',\n",
       " 514: 'least',\n",
       " 515: 'before',\n",
       " 516: 'brains',\n",
       " 517: 'however',\n",
       " 518: 'different',\n",
       " 519: 'frequentflyer',\n",
       " 520: 'takes',\n",
       " 521: 'cheque’',\n",
       " 522: 'keeping',\n",
       " 523: 'those',\n",
       " 524: 'united',\n",
       " 525: 'please',\n",
       " 526: 'approval',\n",
       " 527: 'another',\n",
       " 528: 'yes',\n",
       " 529: 'incorrect',\n",
       " 530: 'run',\n",
       " 531: 'can’t',\n",
       " 532: 'got',\n",
       " 533: 'high',\n",
       " 534: 'treated',\n",
       " 535: 'fees',\n",
       " 536: 'relationship',\n",
       " 537: 'buy',\n",
       " 538: 'charges',\n",
       " 539: 'draw',\n",
       " 540: 'normal',\n",
       " 541: 'online',\n",
       " 542: 'flooring',\n",
       " 543: 'possible',\n",
       " 544: 'used',\n",
       " 545: 'overspend',\n",
       " 546: 'along',\n",
       " 547: 'percentage',\n",
       " 548: 'financial',\n",
       " 549: 'address',\n",
       " 550: 'beneficiary',\n",
       " 551: 'against',\n",
       " 552: 'benefits',\n",
       " 553: 'cheque',\n",
       " 554: 'differently',\n",
       " 555: 'password',\n",
       " 556: 'endorsing’',\n",
       " 557: 'agency',\n",
       " 558: 'annual',\n",
       " 559: 'concept',\n",
       " 560: 'float',\n",
       " 561: 'efficient',\n",
       " 562: 'offering',\n",
       " 563: 'plastic',\n",
       " 564: 'which',\n",
       " 565: 'endorsing',\n",
       " 566: 'report',\n",
       " 567: 'video',\n",
       " 568: 'moved',\n",
       " 569: '“use',\n",
       " 570: 'accounting',\n",
       " 571: 'complete',\n",
       " 572: 'score',\n",
       " 573: 'information',\n",
       " 574: 'stop',\n",
       " 575: 'fee',\n",
       " 576: 'almost',\n",
       " 577: 'known',\n",
       " 578: 'endorsed',\n",
       " 579: 'the',\n",
       " 580: 'transferring',\n",
       " 581: 'certain',\n",
       " 582: 'prompt',\n",
       " 583: 'as',\n",
       " 584: 'well',\n",
       " 585: 'take',\n",
       " 586: 'mental',\n",
       " 587: 'immediately',\n",
       " 588: 'issuer',\n",
       " 589: 'aunsecured',\n",
       " 590: 'person',\n",
       " 591: 'cash',\n",
       " 592: 'checkbook',\n",
       " 593: 'meaning',\n",
       " 594: 'doesn’t',\n",
       " 595: 'refer',\n",
       " 596: 'security',\n",
       " 597: 'even',\n",
       " 598: 'important',\n",
       " 599: 'one',\n",
       " 600: 'understand',\n",
       " 601: 'forming',\n",
       " 602: 'network',\n",
       " 603: 'checks',\n",
       " 604: 'type',\n",
       " 605: 'form',\n",
       " 606: 'difference',\n",
       " 607: 'only',\n",
       " 608: 'using',\n",
       " 609: 'card',\n",
       " 610: 'etc',\n",
       " 611: '18',\n",
       " 612: 'until',\n",
       " 613: '1%',\n",
       " 614: 'order',\n",
       " 615: 'returns',\n",
       " 616: 'benefit',\n",
       " 617: 'resolve',\n",
       " 618: 'whether',\n",
       " 619: 'all',\n",
       " 620: 'would',\n",
       " 621: 'cheques',\n",
       " 622: 'happen',\n",
       " 623: 'clear',\n",
       " 624: 'pay',\n",
       " 625: 'compared',\n",
       " 626: '‘endorsing',\n",
       " 627: 'bounce',\n",
       " 628: 'instead',\n",
       " 629: 'expires',\n",
       " 630: 'days',\n",
       " 631: 'i',\n",
       " 632: 'ensure',\n",
       " 633: 'value',\n",
       " 634: 'both',\n",
       " 635: 'eitherdebit',\n",
       " 636: 'else',\n",
       " 637: 'safe',\n",
       " 638: 'credit',\n",
       " 639: 'increase',\n",
       " 640: 'cd',\n",
       " 641: 'while',\n",
       " 642: 'depend',\n",
       " 643: 'this',\n",
       " 644: 'lose',\n",
       " 645: 'scores',\n",
       " 646: 'happens',\n",
       " 647: 'perk',\n",
       " 648: 'fraudulently',\n",
       " 649: 'how',\n",
       " 650: 'rental',\n",
       " 651: 'then',\n",
       " 652: 'bonus',\n",
       " 653: 'avoid',\n",
       " 654: 'unclaimed',\n",
       " 655: 'funds',\n",
       " 656: 'product',\n",
       " 657: 'partner',\n",
       " 658: 'shop',\n",
       " 659: 'forehead',\n",
       " 660: 'abandoned',\n",
       " 661: 'blocked',\n",
       " 662: 'fico',\n",
       " 663: 'good',\n",
       " 664: 'deposit',\n",
       " 665: 'auto',\n",
       " 666: 'image',\n",
       " 667: 'limit',\n",
       " 668: '“wire',\n",
       " 669: 'easier',\n",
       " 670: '57',\n",
       " 671: 'lucrative',\n",
       " 672: 'setter',\n",
       " 673: 'should',\n",
       " 674: 'purchasing',\n",
       " 675: 'habits',\n",
       " 676: 'number',\n",
       " 677: 'payee',\n",
       " 678: 'gift',\n",
       " 679: 'having',\n",
       " 680: 'sent',\n",
       " 681: 'dedit',\n",
       " 682: 'discover',\n",
       " 683: 'called',\n",
       " 684: 'evidence',\n",
       " 685: 'go',\n",
       " 686: 'clearing',\n",
       " 687: 'developed',\n",
       " 688: 'instant',\n",
       " 689: 'transactions',\n",
       " 690: 'very',\n",
       " 691: 'email',\n",
       " 692: 'receive',\n",
       " 693: 'methods',\n",
       " 694: '48',\n",
       " 695: 'visit',\n",
       " 696: 'bob',\n",
       " 697: 'difficult',\n",
       " 698: 'cannot',\n",
       " 699: 'billers',\n",
       " 700: 'in',\n",
       " 701: 'under',\n",
       " 702: 'lowest',\n",
       " 703: '2%',\n",
       " 704: 'chexsystems',\n",
       " 705: 'working',\n",
       " 706: 'cardrelated',\n",
       " 707: 'globally',\n",
       " 708: 'via',\n",
       " 709: 'not',\n",
       " 710: 'notice',\n",
       " 711: 'independently',\n",
       " 712: 'users',\n",
       " 713: 'vendors',\n",
       " 714: 'program',\n",
       " 715: 'data',\n",
       " 716: 'guarantees',\n",
       " 717: 'novel',\n",
       " 718: 'individual',\n",
       " 719: 'logo',\n",
       " 720: 'guaranteed',\n",
       " 721: 'advantage',\n",
       " 722: 'sure',\n",
       " 723: 'writing',\n",
       " 724: 'person’s',\n",
       " 725: 'venders',\n",
       " 726: 'made',\n",
       " 727: 'dont',\n",
       " 728: 'customers',\n",
       " 729: 'charge',\n",
       " 730: 'truth',\n",
       " 731: 'individual’s',\n",
       " 732: 'realize',\n",
       " 733: 'have',\n",
       " 734: 'american',\n",
       " 735: 'much',\n",
       " 736: 'forms',\n",
       " 737: 'time',\n",
       " 738: 'cashback',\n",
       " 739: 'were',\n",
       " 740: 'scammer',\n",
       " 741: 'each',\n",
       " 742: 'faith',\n",
       " 743: 'opt',\n",
       " 744: 'employee',\n",
       " 745: 'troubles',\n",
       " 746: 'deposits',\n",
       " 747: 'placing',\n",
       " 748: 'starts',\n",
       " 749: 'due',\n",
       " 750: 'amount',\n",
       " 751: 'you',\n",
       " 752: 'matured',\n",
       " 753: 'amounts',\n",
       " 754: 'grace',\n",
       " 755: 'warranties',\n",
       " 756: 'its',\n",
       " 757: 'lower',\n",
       " 758: 'straightforward',\n",
       " 759: 'when',\n",
       " 760: 'automatically',\n",
       " 761: 'states',\n",
       " 762: 'redeemed',\n",
       " 763: 'fair',\n",
       " 764: 'circumstances',\n",
       " 765: 'my',\n",
       " 766: 'updated',\n",
       " 767: 'that',\n",
       " 768: 'cashier’s',\n",
       " 769: 'applying',\n",
       " 770: 'apr',\n",
       " 771: 'incur',\n",
       " 772: 'mother’s',\n",
       " 773: 'signup',\n",
       " 774: 'established',\n",
       " 775: 'what',\n",
       " 776: 'cleared',\n",
       " 777: 'early',\n",
       " 778: 'help',\n",
       " 779: 'quickly',\n",
       " 780: 'shows',\n",
       " 781: 'grout',\n",
       " 782: 'consequences',\n",
       " 783: 'police',\n",
       " 784: 'change',\n",
       " 785: 'earn',\n",
       " 786: 'attempt',\n",
       " 787: 'charged',\n",
       " 788: 'specific',\n",
       " 789: 'subject',\n",
       " 790: 'these',\n",
       " 791: 'afford',\n",
       " 792: 'particularly',\n",
       " 793: 'work',\n",
       " 794: '‘account',\n",
       " 795: 'once',\n",
       " 796: 'protection',\n",
       " 797: 'an',\n",
       " 798: 'just',\n",
       " 799: 'redeem',\n",
       " 800: 'exactly',\n",
       " 801: 'india',\n",
       " 802: 'account—and',\n",
       " 803: 'banks',\n",
       " 804: 'warranty',\n",
       " 805: 'plan',\n",
       " 806: 'reward',\n",
       " 807: 'cashier',\n",
       " 808: 'over',\n",
       " 809: 'collection',\n",
       " 810: 'small',\n",
       " 811: 'hire',\n",
       " 812: 'laws',\n",
       " 813: 'float”',\n",
       " 814: 'it’s',\n",
       " 815: '$50',\n",
       " 816: 'sold',\n",
       " 817: 'come',\n",
       " 818: 'atms',\n",
       " 819: '5',\n",
       " 820: 'people',\n",
       " 821: 'six',\n",
       " 822: 'narrow',\n",
       " 823: 'wait',\n",
       " 824: 'elect',\n",
       " 825: 'direct',\n",
       " 826: 'citibank4',\n",
       " 827: 'inside',\n",
       " 828: 'save',\n",
       " 829: 'branch',\n",
       " 830: 'operate',\n",
       " 831: 'authorization',\n",
       " 832: 'bad',\n",
       " 833: 'carry',\n",
       " 834: 'is',\n",
       " 835: 'really',\n",
       " 836: 'website',\n",
       " 837: 'billing',\n",
       " 838: 'maiden',\n",
       " 839: 'after',\n",
       " 840: 'bulky',\n",
       " 841: 'quick',\n",
       " 842: 'around',\n",
       " 843: 'actually',\n",
       " 844: 'your',\n",
       " 845: 'rewards',\n",
       " 846: 'authorise',\n",
       " 847: 'grown',\n",
       " 848: 'additional',\n",
       " 849: 'institution’s',\n",
       " 850: 'still',\n",
       " 851: 'plenty',\n",
       " 852: 'problems',\n",
       " 853: 'send',\n",
       " 854: 'international',\n",
       " 855: 'excellent',\n",
       " 856: 'method',\n",
       " 857: 'hold',\n",
       " 858: 'remove',\n",
       " 859: 'lifestyle',\n",
       " 860: 'items',\n",
       " 861: 'there’s',\n",
       " 862: 'interest',\n",
       " 863: 'official',\n",
       " 864: 'worst',\n",
       " 865: 'httpswwwinvestopediacomarticlespf10creditcarddebitcardasp',\n",
       " 866: 'addition',\n",
       " 867: 'i’d',\n",
       " 868: 'often',\n",
       " 869: 'granted',\n",
       " 870: 'today',\n",
       " 871: 'insert',\n",
       " 872: 'know',\n",
       " 873: 'three',\n",
       " 874: 'bank',\n",
       " 875: 'dates',\n",
       " 876: 'does',\n",
       " 877: 'say',\n",
       " 878: 'offers',\n",
       " 879: 'displays',\n",
       " 880: 'involve',\n",
       " 881: 'reloadable',\n",
       " 882: 'mean',\n",
       " 883: 'deposited',\n",
       " 884: 'date',\n",
       " 885: 'block',\n",
       " 886: 'technical',\n",
       " 887: 'saving',\n",
       " 889: '<PAD>',\n",
       " 890: '<EOS>',\n",
       " 891: '<OUT>',\n",
       " 892: '<SOS>'}"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "answersint2word"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in range(len(clean_answers)):\n",
    "    clean_answers[i]+=' <EOS>'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [],
   "source": [
    "questions_to_int=[]\n",
    "for question in clean_questions:\n",
    "    ints=[]\n",
    "    for word in question.split():\n",
    "        if word not in questionsWord2int:\n",
    "            ints.append(questionsWord2int['<OUT>'])\n",
    "        else:\n",
    "            ints.append(questionsWord2int[word])\n",
    "    questions_to_int.append(ints)\n",
    "    \n",
    "answers_to_int=[]\n",
    "for answer in clean_answers:\n",
    "    ints=[]\n",
    "    for word in answer.split():\n",
    "        if word not in answersWord2int:\n",
    "            ints.append(answersWord2int['<OUT>'])\n",
    "        else:\n",
    "            ints.append(answersWord2int[word])\n",
    "    answers_to_int.append(ints)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [],
   "source": [
    "#sorting question, answer by the lenth\n",
    "sorted_clean_questions=[]\n",
    "sorted_clean_answers=[]\n",
    "for length in range(1,25+1):\n",
    "    for i in enumerate(questions_to_int):\n",
    "        if len(i[1])==length:\n",
    "            sorted_clean_questions.append(questions_to_int[i[0]])\n",
    "            sorted_clean_answers.append(answers_to_int[i[0]])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[[519, 10],\n",
       " [775, 834, 368],\n",
       " [775, 834, 638, 609],\n",
       " [775, 834, 638, 126],\n",
       " [775, 834, 268, 212],\n",
       " [649, 558, 547, 108, 70],\n",
       " [775, 834, 396, 17, 196],\n",
       " [775, 834, 396, 206, 196],\n",
       " [446, 502, 124, 407, 507],\n",
       " [834, 268, 367, 180, 271],\n",
       " [775, 646, 149, 396, 268, 161],\n",
       " [507, 139, 158, 236, 638, 165],\n",
       " [649, 663, 834, 638, 609, 738],\n",
       " [649, 876, 131, 324, 713, 90],\n",
       " [649, 638, 609, 778, 700, 219],\n",
       " [775, 128, 688, 526, 638, 165],\n",
       " [507, 139, 820, 166, 154, 165],\n",
       " [834, 396, 874, 268, 720, 655],\n",
       " [507, 834, 765, 874, 456, 709, 265],\n",
       " [775, 139, 751, 882, 421, 117, 556],\n",
       " [775, 128, 579, 96, 380, 155, 263],\n",
       " [68, 765, 638, 609, 143, 418, 545],\n",
       " [775, 128, 579, 29, 16, 250, 541],\n",
       " [507, 284, 579, 874, 661, 765, 497],\n",
       " [190, 803, 585, 621, 326, 354, 803],\n",
       " [649, 876, 797, 147, 664, 639, 110],\n",
       " [649, 139, 631, 653, 874, 535, 100, 538],\n",
       " [775, 128, 579, 96, 380, 392, 700, 803],\n",
       " [775, 646, 149, 751, 627, 396, 188, 268],\n",
       " [190, 751, 591, 396, 268, 329, 797, 147],\n",
       " [649, 139, 268, 746, 793, 329, 579, 147],\n",
       " [775, 646, 149, 751, 664, 396, 188, 268],\n",
       " [649, 876, 396, 305, 664, 396, 188, 268],\n",
       " [775, 646, 149, 396, 268, 834, 709, 883],\n",
       " [775, 646, 149, 751, 664, 396, 188, 268],\n",
       " [759, 834, 396, 664, 456, 235, 660, 502, 654],\n",
       " [759, 673, 631, 799, 845, 251, 396, 638, 609],\n",
       " [775, 149, 631, 531, 624, 765, 638, 609, 475],\n",
       " [834, 396, 154, 609, 361, 289, 396, 638, 609],\n",
       " [649, 637, 834, 396, 154, 609, 16, 541, 183],\n",
       " [775, 573, 139, 631, 236, 289, 143, 396, 376],\n",
       " [128, 40, 535, 1, 289, 679, 396, 154, 609],\n",
       " [190, 631, 664, 271, 512, 2, 765, 874, 456],\n",
       " [775, 128, 579, 518, 56, 751, 190, 830, 844, 392],\n",
       " [775, 139, 631, 236, 289, 433, 16, 396, 638, 609],\n",
       " [649, 834, 396, 638, 609, 518, 326, 396, 154, 609],\n",
       " [775, 736, 380, 376, 190, 631, 166, 16, 579, 689],\n",
       " [775, 834, 579, 606, 239, 368, 100, 396, 480, 376],\n",
       " [775, 834, 797, 558, 575, 100, 121, 139, 631, 422, 476],\n",
       " [649, 405, 139, 751, 733, 289, 274, 289, 481, 681, 609],\n",
       " [775, 646, 149, 631, 166, 396, 664, 147, 326, 527, 874],\n",
       " [649, 139, 631, 268, 765, 874, 456, 17, 319, 396, 173, 676],\n",
       " [649, 139, 631, 481, 396, 154, 609, 149, 631, 733, 470, 681, 135],\n",
       " [649, 50, 876, 131, 585, 16, 396, 638, 609, 497, 289, 86, 149, 631, 624, 541],\n",
       " [149,\n",
       "  751,\n",
       "  128,\n",
       "  217,\n",
       "  541,\n",
       "  834,\n",
       "  131,\n",
       "  313,\n",
       "  289,\n",
       "  624,\n",
       "  421,\n",
       "  638,\n",
       "  609,\n",
       "  502,\n",
       "  154,\n",
       "  609],\n",
       " [246,\n",
       "  154,\n",
       "  165,\n",
       "  817,\n",
       "  489,\n",
       "  845,\n",
       "  502,\n",
       "  354,\n",
       "  458,\n",
       "  16,\n",
       "  608,\n",
       "  87,\n",
       "  649,\n",
       "  190,\n",
       "  631,\n",
       "  872,\n",
       "  564,\n",
       "  599,\n",
       "  834,\n",
       "  396,\n",
       "  663,\n",
       "  355],\n",
       " [149,\n",
       "  631,\n",
       "  166,\n",
       "  396,\n",
       "  154,\n",
       "  609,\n",
       "  289,\n",
       "  143,\n",
       "  396,\n",
       "  77,\n",
       "  190,\n",
       "  579,\n",
       "  384,\n",
       "  114,\n",
       "  396,\n",
       "  504,\n",
       "  885,\n",
       "  502,\n",
       "  857,\n",
       "  251,\n",
       "  354,\n",
       "  655],\n",
       " [149,\n",
       "  631,\n",
       "  166,\n",
       "  396,\n",
       "  154,\n",
       "  609,\n",
       "  289,\n",
       "  143,\n",
       "  396,\n",
       "  77,\n",
       "  190,\n",
       "  579,\n",
       "  384,\n",
       "  114,\n",
       "  396,\n",
       "  504,\n",
       "  885,\n",
       "  502,\n",
       "  857,\n",
       "  251,\n",
       "  354,\n",
       "  655,\n",
       "  700,\n",
       "  765,\n",
       "  456]]"
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sorted_clean_questions"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Tensorflow\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [],
   "source": [
    "def model_inputs():\n",
    "    inputs=tf.placeholder(tf.int32, [None,None], name='input')\n",
    "    targets=tf.placeholder(tf.int32, [None,None], name='target')\n",
    "    lr=tf.placeholder(tf.float32, name='learning_rate')\n",
    "    keep_prob=tf.placeholder(tf.float32, name='keep_prob')\n",
    "    return inputs,targets,lr,keep_prob"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [],
   "source": [
    "#adding SOS token\n",
    "# Preprocessing the targets\n",
    "def preprocess_targets(targets, word2int, batch_size):\n",
    "    left_side = tf.fill([batch_size, 1], word2int['<SOS>'])\n",
    "    right_side = tf.strided_slice(targets, [0,0], [batch_size, -1], [1,1])\n",
    "    preprocessed_targets = tf.concat([left_side, right_side], 1)\n",
    "    return preprocessed_targets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Creating the Encoder RNN\n",
    "def encoder_rnn(rnn_inputs, rnn_size, num_layers, keep_prob, sequence_length):\n",
    "    lstm = tf.contrib.rnn.BasicLSTMCell(rnn_size)\n",
    "    lstm_dropout = tf.contrib.rnn.DropoutWrapper(lstm, input_keep_prob = keep_prob)\n",
    "    encoder_cell = tf.contrib.rnn.MultiRNNCell([lstm_dropout] * num_layers)\n",
    "    encoder_output, encoder_state = tf.nn.bidirectional_dynamic_rnn(cell_fw = encoder_cell,cell_bw = encoder_cell,sequence_length = sequence_length,inputs = rnn_inputs,dtype = tf.float32)\n",
    "    return encoder_state"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Decoding the training set\n",
    "def decode_training_set(encoder_state, decoder_cell, decoder_embedded_input, sequence_length, decoding_scope, output_function, keep_prob, batch_size):\n",
    "    attention_states = tf.zeros([batch_size, 1, decoder_cell.output_size])\n",
    "    attention_keys, attention_values, attention_score_function, attention_construct_function = tf.contrib.seq2seq.prepare_attention(attention_states, attention_option = \"bahdanau\", num_units = decoder_cell.output_size)\n",
    "    training_decoder_function = tf.contrib.seq2seq.attention_decoder_fn_train(encoder_state[0],attention_keys,attention_values,attention_score_function,attention_construct_function,name = \"attn_dec_train\")\n",
    "    decoder_output, decoder_final_state, decoder_final_context_state = tf.contrib.seq2seq.dynamic_rnn_decoder(decoder_cell,training_decoder_function,decoder_embedded_input,sequence_length,scope = decoding_scope)\n",
    "    decoder_output_dropout = tf.nn.dropout(decoder_output, keep_prob)\n",
    "    return output_function(decoder_output_dropout)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Decoding the test/validation set\n",
    "def decode_test_set(encoder_state, decoder_cell, decoder_embeddings_matrix, sos_id, eos_id, maximum_length, num_words, decoding_scope, output_function, keep_prob, batch_size):\n",
    "    attention_states = tf.zeros([batch_size, 1, decoder_cell.output_size])\n",
    "    attention_keys, attention_values, attention_score_function, attention_construct_function = tf.contrib.seq2seq.prepare_attention(attention_states, attention_option = \"bahdanau\", num_units = decoder_cell.output_size)\n",
    "    test_decoder_function = tf.contrib.seq2seq.attention_decoder_fn_inference(output_function,encoder_state[0],attention_keys,attention_values,attention_score_function,attention_construct_function,decoder_embeddings_matrix,sos_id,eos_id,maximum_length,num_words,name = \"attn_dec_inf\")\n",
    "    test_predictions, decoder_final_state, decoder_final_context_state = tf.contrib.seq2seq.dynamic_rnn_decoder(decoder_cell,test_decoder_function,scope = decoding_scope)\n",
    "    return test_predictions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "metadata": {},
   "outputs": [],
   "source": [
    "def decoder_rnn(decoder_embedded_input, decoder_embeddings_matrix, encoder_state, num_words, sequence_length, rnn_size, num_layers, word2int, keep_prob, batch_size):\n",
    "    with tf.variable_scope(\"decoding\") as decoding_scope:\n",
    "        lstm = tf.contrib.rnn.BasicLSTMCell(rnn_size)\n",
    "        lstm_dropout = tf.contrib.rnn.DropoutWrapper(lstm, input_keep_prob = keep_prob)\n",
    "        decoder_cell = tf.contrib.rnn.MultiRNNCell([lstm_dropout] * num_layers)\n",
    "        weights = tf.truncated_normal_initializer(stddev = 0.1)\n",
    "        biases = tf.zeros_initializer()\n",
    "        output_function = lambda x: tf.contrib.layers.fully_connected(x,num_words,None,scope = decoding_scope,weights_initializer = weights,biases_initializer = biases)\n",
    "        training_predictions = decode_training_set(encoder_state,decoder_cell,decoder_embedded_input,sequence_length,decoding_scope,output_function,keep_prob,batch_size)\n",
    "        decoding_scope.reuse_variables()\n",
    "        test_predictions = decode_test_set(encoder_state,decoder_cell,decoder_embeddings_matrix,word2int['<SOS>'],word2int['<EOS>'],sequence_length - 1,num_words,decoding_scope,output_function,keep_prob,batch_size)\n",
    "    return training_predictions, test_predictions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Building the seq2seq model\n",
    "def seq2seq_model(inputs, targets, keep_prob, batch_size, sequence_length, answers_num_words, questions_num_words, encoder_embedding_size, decoder_embedding_size, rnn_size, num_layers, questionswords2int):\n",
    "    encoder_embedded_input = tf.contrib.layers.embed_sequence(inputs,answers_num_words + 1,encoder_embedding_size,initializer = tf.random_uniform_initializer(0, 1))\n",
    "    encoder_state = encoder_rnn(encoder_embedded_input, rnn_size, num_layers, keep_prob, sequence_length)\n",
    "    preprocessed_targets = preprocess_targets(targets, questionswords2int, batch_size)\n",
    "    decoder_embeddings_matrix = tf.Variable(tf.random_uniform([questions_num_words + 1, decoder_embedding_size], 0, 1))\n",
    "    decoder_embedded_input = tf.nn.embedding_lookup(decoder_embeddings_matrix, preprocessed_targets)\n",
    "    training_predictions, test_predictions = decoder_rnn(decoder_embedded_input,decoder_embeddings_matrix,encoder_state,questions_num_words,sequence_length,rnn_size,num_layers,questionswords2int,keep_prob,batch_size)\n",
    "    return training_predictions, test_predictions"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# training\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Setting the Hyperparameters\n",
    "epochs = 100\n",
    "batch_size = 64\n",
    "rnn_size = 512\n",
    "num_layers = 3\n",
    "encoding_embedding_size = 512\n",
    "decoding_embedding_size = 512\n",
    "learning_rate = 0.01\n",
    "learning_rate_decay = 0.9\n",
    "min_learning_rate = 0.0001\n",
    "keep_probability = 0.5\n",
    " \n",
    "# Defining a session\n",
    "tf.reset_default_graph()\n",
    "session = tf.InteractiveSession()\n",
    " \n",
    "# Loading the model inputs\n",
    "inputs, targets, lr, keep_prob = model_inputs()\n",
    " \n",
    "# Setting the sequence length\n",
    "sequence_length = tf.placeholder_with_default(25, None, name = 'sequence_length')\n",
    " \n",
    "# Getting the shape of the inputs tensor\n",
    "input_shape = tf.shape(inputs)\n",
    " \n",
    "# Getting the training and test predictions\n",
    "training_predictions, test_predictions = seq2seq_model(tf.reverse(inputs, [-1]),targets,keep_prob,batch_size,sequence_length,len(answersWord2int),len(questionsWord2int),encoding_embedding_size,decoding_embedding_size,rnn_size,num_layers,questionsWord2int)\n",
    " \n",
    "# Setting up the Loss Error, the Optimizer and Gradient Clipping\n",
    "with tf.name_scope(\"optimization\"):\n",
    "    loss_error = tf.contrib.seq2seq.sequence_loss(training_predictions,targets,tf.ones([input_shape[0], sequence_length]))\n",
    "    optimizer = tf.train.AdamOptimizer(learning_rate)\n",
    "    gradients = optimizer.compute_gradients(loss_error)\n",
    "    clipped_gradients = [(tf.clip_by_value(grad_tensor, -5., 5.), grad_variable) for grad_tensor, grad_variable in gradients if grad_tensor is not None]\n",
    "    optimizer_gradient_clipping = optimizer.apply_gradients(clipped_gradients)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Padding the sequences with the <PAD> token\n",
    "def apply_padding(batch_of_sequences, word2int):\n",
    "    max_sequence_length = max([len(sequence) for sequence in batch_of_sequences])\n",
    "    return [sequence + [word2int['<PAD>']] * (max_sequence_length - len(sequence)) for sequence in batch_of_sequences]\n",
    " \n",
    "# Splitting the data into batches of questions and answers\n",
    "def split_into_batches(questions, answers, batch_size):\n",
    "    for batch_index in range(0, len(questions) // batch_size):\n",
    "        start_index = batch_index * batch_size\n",
    "        questions_in_batch = questions[start_index : start_index + batch_size]\n",
    "        answers_in_batch = answers[start_index : start_index + batch_size]\n",
    "        padded_questions_in_batch = np.array(apply_padding(questions_in_batch, questionsWord2int))\n",
    "        padded_answers_in_batch = np.array(apply_padding(answers_in_batch, answersWord2int))\n",
    "        yield padded_questions_in_batch, padded_answers_in_batch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Splitting the questions and answers into training and validation sets\n",
    "training_validation_split = int(len(sorted_clean_questions) * 0.15)\n",
    "training_questions = sorted_clean_questions[training_validation_split:]\n",
    "training_answers = sorted_clean_answers[training_validation_split:]\n",
    "validation_questions = sorted_clean_questions[:training_validation_split]\n",
    "validation_answers = sorted_clean_answers[:training_validation_split]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Training\n",
    "batch_index_check_training_loss = 100\n",
    "batch_index_check_validation_loss = ((len(training_questions)) // batch_size // 2) - 1\n",
    "total_training_loss_error = 0\n",
    "list_validation_loss_error = []\n",
    "early_stopping_check = 0\n",
    "early_stopping_stop = 1000\n",
    "checkpoint = \"./chatbot_weights.ckpt\" # For Windows users, replace this line of code by: checkpoint = \"./chatbot_weights.ckpt\"\n",
    "session.run(tf.global_variables_initializer())\n",
    "for epoch in range(1, epochs + 1):\n",
    "    for batch_index, (padded_questions_in_batch, padded_answers_in_batch) in enumerate(split_into_batches(training_questions, training_answers, batch_size)):\n",
    "        starting_time = time.time()\n",
    "        _, batch_training_loss_error = session.run([optimizer_gradient_clipping, loss_error], {inputs: padded_questions_in_batch,targets: padded_answers_in_batch,lr: learning_rate,sequence_length: padded_answers_in_batch.shape[1],keep_prob: keep_probability})\n",
    "        total_training_loss_error += batch_training_loss_error\n",
    "        ending_time = time.time()\n",
    "        batch_time = ending_time - starting_time\n",
    "        if batch_index % batch_index_check_training_loss == 0:\n",
    "            print('Epoch: {:>3}/{}, Batch: {:>4}/{}, Training Loss Error: {:>6.3f}, Training Time on 100 Batches: {:d} seconds'.format(epoch,epochs,batch_index,len(training_questions) // batch_size,total_training_loss_error / batch_index_check_training_loss,int(batch_time * batch_index_check_training_loss)))\n",
    "            total_training_loss_error = 0\n",
    "        if batch_index % batch_index_check_validation_loss == 0 and batch_index > 0:\n",
    "            total_validation_loss_error = 0\n",
    "            starting_time = time.time()\n",
    "            for batch_index_validation, (padded_questions_in_batch, padded_answers_in_batch) in enumerate(split_into_batches(validation_questions, validation_answers, batch_size)):\n",
    "                batch_validation_loss_error = session.run(loss_error, {inputs: padded_questions_in_batch,targets: padded_answers_in_batch,lr: learning_rate,sequence_length: padded_answers_in_batch.shape[1],keep_prob: 1})\n",
    "                total_validation_loss_error += batch_validation_loss_error\n",
    "            ending_time = time.time()\n",
    "            batch_time = ending_time - starting_time\n",
    "            average_validation_loss_error = total_validation_loss_error / (len(validation_questions) / batch_size)\n",
    "            print('Validation Loss Error: {:>6.3f}, Batch Validation Time: {:d} seconds'.format(average_validation_loss_error, int(batch_time)))\n",
    "            learning_rate *= learning_rate_decay\n",
    "            if learning_rate < min_learning_rate:\n",
    "                learning_rate = min_learning_rate\n",
    "            list_validation_loss_error.append(average_validation_loss_error)\n",
    "            if average_validation_loss_error <= min(list_validation_loss_error):\n",
    "                print('I speak better now!!')\n",
    "                early_stopping_check = 0\n",
    "                saver = tf.train.Saver()\n",
    "                saver.save(session, checkpoint)\n",
    "            else:\n",
    "                print(\"Sorry I do not speak better, I need to practice more.\")\n",
    "                early_stopping_check += 1\n",
    "                if early_stopping_check == early_stopping_stop:\n",
    "                    break\n",
    "    if early_stopping_check == early_stopping_stop:\n",
    "        print(\"My apologies, I cannot speak better anymore. This is the best I can do.\")\n",
    "        break\n",
    "print(\"Game Over\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
